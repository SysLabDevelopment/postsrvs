{"version":3,"sources":["webpack:///src/app/pages/order/order.module.ts","webpack:///src/app/pages/order/order.page.html","webpack:///src/app/pages/order/order.page.ts"],"names":["routes","path","component","OrderPageModule","forChild","imports","declarations","OrderPage","router","route","courier","state$","auth","http","CL","sys","settings","sysMap","data","storage","cache","network","orderService","bs","device","modalController","orderId","clientId","status_id","status","goods","address","order","name","timeFrom","timeTo","phone","pageInit","statuses","id","reasons","reason","commentText","g_quants","changeWindow","selectedPayment","client_status","client_status_dt","client_status_id","order_sum","vlog","poruch","mass","amount","email_input","phone_input","barcode_flag","barcode_url","barcode","selectedReason","selectedStatus","hide_status","$codeStop","showPhone","podrazd","email_error","pay_access","pay_access_data","show_info","show_email","callWindow","drawimage","imageToShow","orderPhones","today","Date","tomorrow","openCompany","drawNeedle","snapshot","paramMap","get","initOrder","img","localStorage","getItem","initStatuses","setDate","getDate","note","url","JSON","stringify","post","need","navigate","removeItem","phones","replace","length","normalizePhoneNumber","push","slice","action","parsePhone","courierPhone","courier_phone","selectedPhone","callNumber","then","type","phoneClick","client_number","cur_number","sendPost","subscribe","resp","console","log","showError","orders","filter","toString","client_address","datetime_from","datetime_to","client_phone","status_text","Number","Podrazd","coords","lt","lg","setQuants","ifPaid","getBalnce","getPayData","initClientInfo","states","client_states","getValue","state_id","client_state","i","state","good","code","Code","count","final_kol_vo","kol_vo","quant","price","Price","q","n_q","getSum","getOrders","getStatus","newStatus","syncRequests","quants","new_plan_date","check","checkBase64Image","saveItem","client_id","localModifyOrders","sendDelayedCall","self","map","saveOrders","next","noSkip","changeStatus","String","undefined","toLocaleDateString","success","updateWayInfo","doOCR","recognizedData","text","presentToast","rur","item","callback_url","proxy","products","good_name","good_amount","good_price","Math","round","pos","quantity","purchase","api_key","login","cashier","order_data","apikey","cashier_name","mode","customer_email","customer_phone","send_api_data","navigator","onLine","res","api_data","forEach","product","orderData","submitChange","checkPayment","requests","req","interval_1ss","pipe","mail_exp","infoStr","mail","exec","intentStart","showRoute","drawedImg","drawImg","drawBtn","checkPhoto","imageData","sendPayCall","setItem","infoUpdated","meta","label","scan","data1","uuid","changeQuant","create","cssClass","componentProps","showBackdrop","modal","present","onDidDismiss","details","doneOrder","height","selector","animations","templateUrl","styleUrls"],"mappings":"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","file":"pages-order-order-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\nimport { IonicModule } from '@ionic/angular';\nimport { OrderPage } from './order.page';\nimport {IconsModule} from '../../icons/icons.module';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: OrderPage\n  }\n];\n\n@NgModule({\n  imports: [\n    IconsModule,\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [OrderPage]\n})\nexport class OrderPageModule { }\n","<ion-header>\n  <ion-toolbar>\n    <ion-buttons slot=\"start\">\n      <ion-back-button></ion-back-button>\n    </ion-buttons>\n    <ion-title *ngIf='order'>{{order.client_id}}</ion-title>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content *ngIf=\"order\">\n  <ion-list>\n    <ion-item>\n      <ion-label>\n        <div class='flex'>\n          <img src=\"../../../assets/a-b.svg\">\n          <div class='addresses'>\n            Адрес отправителя:\n            <p>{{order.company_address}}</p>\n            Адрес получателя:\n            <p>{{order.client_address}}</p>\n          </div>\n        </div>\n        <div class='client-id'>\n          Шифр: <span>{{order.client_id}} </span>\n        </div>\n      </ion-label>\n    </ion-item>\n    <ion-item class='datetime'>\n      <ion-label>\n        <div>\n          Дата доставки:\n          <p>\n            <span>\n              {{order.datetime_to | date: 'd.MM.yyyy'}}\n            </span>\n          </p>\n        </div>\n        <div class='time'>\n          Время доставки:\n          <p>\n            После <span>{{order.datetime_from | date: 'H:mm'}}</span> До\n            <span>{{order.datetime_to | date: 'H:mm'}}</span>\n          </p>\n        </div>\n      </ion-label>\n    </ion-item>\n    <ion-item>\n      <ion-label>\n        <div class='flex main-info'>\n          <div>\n            Имя: <span class='bold'>{{order.client_fio}} </span><br>\n            Компания: <span class='bold'>{{order.client_name}} </span>\n          </div>\n          <div>\n            Робот прозвон:\n            <div class=\"st_state\" [ngClass]=\"{\n              'status_done' : order.client_status_id == 1,\n              'status_wait' : order.client_status_id == 2,\n              'status_fail' : order.client_status_id == 3,\n              'status_none' : order.client_status_id == 8,\n              'cl-status-voice' : order.client_status_id == 4 }\">\n              {{order.client_status}}\n            </div>\n          </div>\n          <div>\n            Сумма с клиента:\n            <div class='primary-color bold' *ngIf='order.rur'>\n              {{order.rur.toLocaleString('ru')}} р.\n            </div>\n          </div>\n          <div>\n            Количество / Вес\n            <div class='primary-color bold'>{{order.amount}} шт. / {{order.mass}} кг</div>\n          </div>\n        </div>\n        <ion-button id='call' expand='full' fill='solid' (click)=\"phoneClick('init')\">\n          Позвонить клиенту\n        </ion-button>\n      </ion-label>\n    </ion-item>\n    <ion-item class='yellow'>\n      <ion-label>\n        Статус: <span class='bold'>{{getStatus()}} </span>\n      </ion-label>\n    </ion-item>\n    <ion-item *ngIf=\"order.poruch\">\n      <ion-label>\n        Комментарий к заказу\n        <div class='bold'>\n          {{order.poruch}}\n        </div>\n      </ion-label>\n    </ion-item>\n    <ion-item>\n      <ion-label [@openClose]=\"openCompany ? 'open' : 'closed'\">\n        Компания отправитель:\n        <div class='bold'>\n          {{order.company}}\n        </div>\n        <ion-card id=\"company-card\">\n          <ion-item class=\"ion-activated\" *ngIf=\"order.Cname\">\n            <ion-label>\n              <h3>Ответственное лицо</h3>\n              {{order.Cname}}\n            </ion-label>\n          </ion-item>\n          <ion-item class=\"ion-activated\" *ngIf=\"order.Cadress\">\n            <ion-label>\n              <h3>Адрес</h3>\n              {{order.Cadress}}\n            </ion-label>\n          </ion-item>\n          <ion-item class=\"ion-activated\" *ngIf=\"order.Cphone\">\n            <ion-label>\n              <h3>Основной телефон</h3>\n              {{order.Cphone}}\n            </ion-label>\n          </ion-item>\n          <ion-item class=\"ion-activated\" *ngIf=\"order.Cphone_s\">\n            <ion-label>\n              <h3>Дополнительный телефон</h3>\n              {{order.Cphone_s}}\n            </ion-label>\n          </ion-item>\n        </ion-card>\n      </ion-label>\n      <div class=\"actions-button\" (click)=\"tapBlock()\">\n        <ion-icon src='../../../assets/actions-arrows.svg' [ngClass]=\"{turned: openCompany == true }\"></ion-icon>\n      </div>\n    </ion-item>\n    <ion-item id='note-item'>\n      <ion-input placeholder='Введите заметку по заказу' [(ngModel)]=\"note\"></ion-input>\n      <ion-button (click)=\"saveNote()\">\n        <ion-icon slot=\"icon-only\" name=\"save\"></ion-icon>\n      </ion-button>\n    </ion-item>\n  </ion-list>\n  <div id='navigate-buttons'>\n    <ion-button expand=\"block\" fill=\"solid\" shape=\"round\" (click)=\"intentStart()\" class='action'>\n      Открыть в навигаторе\n    </ion-button>\n    <ion-button expand=\"block\" fill=\"solid\" shape=\"round\" (click)=\"showRoute(order)\" class='action'>\n      Показать на карте\n    </ion-button>\n  </div>\n  <div id='done-buttons' *ngIf=\"!(hide_status || status_id == 5 || status_id == 6 || status_id == 4)\">\n    <ion-button expand=\"full\" fill=\"solid\" shape=\"round\" id='light-purple-button' class='action'\n      (click)=\"selectStatus(4); presentNotDeliveredModal()\">\n      <ion-icon slot=\"start\" name=\"close\"></ion-icon>\n      Не доставлено\n    </ion-button>\n    <ion-button expand=\"full\" fill=\"solid\" shape=\"round\" id='light-blue-button' class='action'\n      (click)=\"selectStatus(6)\">\n      <ion-icon slot=\"start\" src='../../../assets/pie-chart.svg'></ion-icon>\n      Частично доставлено\n    </ion-button>\n    <ion-button expand=\"full\" fill=\"solid\" shape=\"round\" id='light-green-button' class='action'\n      (click)=\"selectStatus(5); presentDeliveredModal()\">\n      <ion-icon slot=\"start\" name=\"checkmark-done\"></ion-icon>\n      Доставлено\n    </ion-button>\n  </div>\n  <!-- Легаси! -->\n  <div class=\"sc-row o-row\" *ngIf=\"selectedStatus == 6 ||order.status_id == 6\">\n    <div class=\"sc-goods-block\">\n      <div class=\"goods-row o-row\">\n        <div class=\"gr-title o-t\">Товары в заказе</div>\n\n        <div class=\"gr-goods-list\">\n          <div class=\"gr-head\">\n            <div class=\"gr-col\">Название</div>\n            <div class=\"gr-col\">Кол-во</div>\n            <div class=\"gr-col\">Цена</div>\n          </div>\n          <div *ngFor=\"let good of goods\">\n            <div class=\"gr-item\" [ngClass]=\"{\n                            'st_fail': (g_quants[good.Code]['amount'] == 0),\n                            'st_done': (order.status_id == 6 && g_quants[good.Code]['amount'] > 0 )\n                          }\">\n              <div class=\"gr-col\">{{good.Name}}</div>\n              <div class=\"gr-col gr-quant\">\n                <div (click)=\"changeQuant(good.Code,'minus')\">\n                  <i-feather name=\"minus-circle\"></i-feather>\n                </div>\n                {{g_quants[good.Code]['amount']}}\n                <div (click)=\"changeQuant(good.Code,'plus')\">\n                  <i-feather name=\"plus-circle\"></i-feather>\n                </div>\n              </div>\n              <div class=\"gr-col gr-price\">{{good.Price}}р.</div>\n            </div>\n          </div>\n          <div><b>Итого: </b>{{order.rur}}р.</div>\n        </div>\n      </div>\n    </div>\n    <ion-button (click)=\"scanReturned()\" expand=\"block\" fill=\"solid\" shape=\"round\"\n      *ngIf=\"selectedStatus == 6 ||order.status_id == 6\">\n      Сканировать возврат\n    </ion-button>\n  </div>\n  <div>\n\n    <!-- Блок подписи -->\n    <div class=\"draw\" *ngIf=\"selectedStatus == 6\">\n      <div class=\"asc-row\">\n        <div class=\"title\">Требуется ли подпись клиента?</div>\n        <div class=\"draw-btns\">\n          <button class=\"drawBtn\" [ngClass]=\"{'draw_btn_active'   : drawNeedle}\" (click)=\"drawBtn(true)\">\n            Да\n          </button>\n          <button class=\"drawBtn\" [ngClass]=\"{'draw_btn_active'   : !drawNeedle}\" (click)=\"drawBtn(false)\">\n            Нет\n          </button>\n        </div>\n      </div>\n      <img [src]=\"imageToShow\" alt=\"Подпись\" *ngIf=\"imageToShow && drawNeedle\" style=\"height: 200px;\" />\n      <button *ngIf=\"drawNeedle\" class=\"drawBtn changeDraw\" (click)=\"drawBtn(true)\">Изменить подпись</button>\n    </div>\n    <div class=\"sc-payment\" *ngIf=\"selectedStatus == 6\">\n      <div class=\"sc-payment__title\">Оплата</div>\n      <div class=\"dc-payment__wrp\">\n        <div class=\"sc-payment-item\" [ngClass]=\"{'payment_active' : selectedPayment == 1}\" (click)=\"selectPayment('1')\">\n          Наличными\n        </div>\n        <div class=\"sc-payment-item\" [ngClass]=\"{'payment_active' : selectedPayment == 2}\" (click)=\"selectPayment('2')\">\n          Картой\n        </div>\n      </div>\n    </div>\n\n    <div class=\"sc-payment-block o-row\" *ngIf=\"pay_access && (selectedStatus == 6)  \">\n      <div class=\"pb-email\" *ngIf=\"show_email\">\n        <div class=\"pb-email__title\">Email клиента</div>\n        <input type=\"email\" class=\"pb-email__input\" [(ngModel)]=\"email_input\" />\n      </div>\n      <div class=\"pb-phone\">\n        <div class=\"pb-phone__title\" *ngIf=\"showPhone\">Телефон клиента</div>\n        <input *ngIf=\"showPhone\" type=\"tel\" class=\"pb-phone__input\" [(ngModel)]=\"phone_input\" />\n      </div>\n      <button class=\"show-phone\" (click)=\"enterPhone()\">Прочее</button>\n    </div>\n    <div class=\"dt-picker\" *ngIf=\"selectedReason == 8\">\n      <ion-item>\n        <ion-label position=\"floating\">MM/DD/YYYY</ion-label>\n        <ion-datetime displayFormat=\"DD/MM/YYYY\" min=\"{{today.toISOString()}}\" value=\"{{tomorrow.toISOString()}}\"\n          [(ngModel)]='new_plan_date'></ion-datetime>\n      </ion-item>\n    </div>\n\n    <div class=\"sc-s-wrp\">\n      <button class=\"sc-submit\" (click)=\"doneOrder()\" *ngIf=\"selectedStatus\"\n        [ngClass]=\"{'c_t_del'   : selectedStatus == 5 || selectedStatus == 6}\">\n        <span *ngIf=\"selectedStatus == 5 || selectedStatus == 6\" class=\"l_btn_del\">Доставлено</span>\n      </button>\n    </div>\n  </div>\n  <!-- Конец Легаси -->\n  <div id=\"call-window\" *ngIf=\"callWindow\">\n    <div class=\"cw-body\">\n      <i-feather name=\"x-square\" (click)=\"phoneClick('init')\" size=\"large\"></i-feather>\n      <ion-list *ngIf=\"orderPhones.length > 1\">\n        <ion-radio-group name=\"selectedPhone\" [(ngModel)]=\"selectedPhone\">\n          <ion-list-header>\n            <ion-label>Выберите номер</ion-label>\n          </ion-list-header>\n          <ion-item *ngFor=\"let phone of orderPhones\">\n            <ion-radio value=\"{{phone}}\"></ion-radio>\n            <ion-label>{{phone}}</ion-label>\n          </ion-item>\n        </ion-radio-group>\n      </ion-list>\n      <button (click)=\"phoneClick('phone')\"\n        *ngIf=\"settings.rules.phoneMode == 'robotPhone' || settings.rules.phoneMode == 'phone' \">\n        Позвонить со своего телефона\n      </button>\n      <button (click)=\"phoneClick('operator')\"\n        *ngIf=\"settings.rules.phoneMode == 'robotPhone' || settings.rules.phoneMode == 'robot' \">\n        Позвонить через ip-шлюз\n      </button>\n    </div>\n  </div>\n</ion-content>","import {\n  animate,\n  state,\n  style,\n  transition,\n  trigger\n} from \"@angular/animations\";\nimport { HttpClient } from \"@angular/common/http\";\nimport { Component, OnInit } from \"@angular/core\";\nimport { ActivatedRoute, Router } from \"@angular/router\";\nimport { BarcodeScanner } from '@ionic-native/barcode-scanner/ngx';\nimport { CallNumber } from \"@ionic-native/call-number/ngx\";\nimport { Device } from '@ionic-native/device/ngx';\nimport { Network } from '@ionic-native/network/ngx';\nimport { ModalController } from '@ionic/angular';\nimport { Storage } from \"@ionic/storage\";\nimport { CacheService } from \"ionic-cache\";\nimport { Subject } from \"rxjs\";\nimport { takeUntil } from \"rxjs/operators\";\nimport { Meta } from 'src/app/interfaces/meta';\nimport { Order } from 'src/app/interfaces/order';\nimport { DeliveredComponent } from '../../components/delivered/delivered.component';\nimport { NotDeliveredComponent } from '../../components/not-delivered/not-delivered.component';\nimport { Reason } from \"../../interfaces/reason\";\nimport { Statuses } from \"../../interfaces/statuses\";\nimport { AuthService } from \"../../services/auth.service\";\nimport { CourierService } from \"../../services/courier.service\";\nimport { SettingsService } from \"../../services/settings.service\";\nimport { StateService } from \"../../services/state.service\";\nimport { SysService } from \"../../services/sys.service\";\nimport { MapService } from \"../../services/sys/map.service\";\nimport { OrderService } from '../../services/sys/order.service';\nimport { DataService } from './../../services/sys/data.service';\n\n@Component({\n  selector: \"app-order\",\n  animations: [\n    trigger('openClose', [\n      // ...\n      state('open', style({\n        height: '264px',\n      })),\n      state('closed', style({\n        height: '50px',\n      })),\n      transition('open => closed', [\n        animate('0.5s')\n      ]),\n      transition('closed => open', [\n        animate('0.5s')\n      ]),\n    ])],\n  templateUrl: \"./order.page.html\",\n  styleUrls: [\"./order.page.scss\"],\n})\nexport class OrderPage implements OnInit {\n  public orderId: string = null;\n  public clientId: string = null;\n  public status_id: number = null;\n  public status: string = null;\n  public goods: any = null;\n  public address: any = null;\n  public order: Order = null;\n  public name: string = null;\n  public timeFrom: string = null;\n  public timeTo: string = null;\n  public phone: string = null;\n  public pageInit: boolean = true;\n  public statuses: Statuses[] = [\n    { id: 4, status: \"Не доставлено\" },\n    { id: 5, status: \"Доставлено\" },\n    { id: 6, status: \"Частично доставлено\" },\n  ];\n  public reasons: Reason[] = [\n    { id: 1, reason: \"Не удалось Дозвониться!\" },\n    { id: 2, reason: \"Отказ, при созвоне с клиентом\" },\n    { id: 3, reason: \"Отказ от доставки без объяснения причины\" },\n    { id: 4, reason: \"Ошибка оформления ИМ\" },\n    { id: 5, reason: \"Получатель передумал\" },\n    { id: 6, reason: \"Товар не подошел/не понравился\" },\n    { id: 7, reason: \"Финансовые трудности у получателя\" },\n    { id: 8, reason: \"Перенос даты доставки получателем.\" },\n    { id: 10, reason: \"Не успел\" },\n    { id: 11, reason: \"Переехали/нев.Адрес\" },\n  ];\n  public commentText: any = null;\n  public g_quants: any = {};\n  public changeWindow: boolean = false;\n  public selectedPayment = \"1\";\n  public client_status = \"\";\n  public client_status_dt = \"\";\n  public client_status_id = \"\";\n  public order_sum = null;\n  public vlog = null;\n  public poruch = null;\n  public mass = null;\n  public amount = null;\n  public email_input = \"\";\n  public phone_input = \"\";\n  public barcode_flag = false;\n  public barcode_url = null;\n  public barcode = null;\n  public selectedReason: any = null;\n  public selectedStatus: any = null;\n  public hide_status = false;\n  public $codeStop: Subject<any> = new Subject();\n  public showPhone: boolean = false;\n  public podrazd = null;\n  public email_error = false;\n  public pay_access: boolean = false;\n  public pay_access_data = null;\n  public show_info: boolean = false;\n  public show_email: boolean = false;\n  public callWindow: boolean = false;\n  public drawimage: boolean = false;\n  public imageToShow = null;\n  coords: Array<any>;\n  public orderPhones: Array<string> = [];\n  public selectedPhone: string;\n  public note: string;\n  public today = new Date();\n  public tomorrow = new Date();\n  public new_plan_date: string; //Дата переноса заказа\n  public openCompany = false;\n  public checkBase64Image: string;\n  public drawNeedle: boolean = true;\n\n  constructor(\n    private router: Router,\n    private route: ActivatedRoute,\n    private courier: CourierService,\n    private state$: StateService,\n    private auth: AuthService,\n    private http: HttpClient,\n    private CL: CallNumber,\n    public sys: SysService,\n    public settings: SettingsService,\n    private sysMap: MapService,\n    private data: DataService,\n    private storage: Storage,\n    private cache: CacheService,\n    private network: Network,\n    private orderService: OrderService,\n    private bs: BarcodeScanner,\n    private device: Device,\n    public modalController: ModalController\n  ) {\n    this.orderId = this.route.snapshot.paramMap.get(\"id\");\n\n    this.initOrder();\n    var img = localStorage.getItem(\"drawImg\");\n    if (img) {\n      this.imageToShow = \"data:image/jpg;base64,\" + img;\n    }\n  }\n\n  ngOnInit() {\n    this.courier.initStatuses();\n    this.tomorrow.setDate(this.tomorrow.getDate() + 1);\n    this.note = localStorage.getItem(this.orderId);\n  }\n\n  ngAfterViewChecked() {\n    var img = localStorage.getItem(\"drawImg\");\n    if (img) {\n      this.imageToShow = \"data:image/jpg;base64,\" + img;\n    }\n  }\n\n  public sendPost(url, data) {\n    data = JSON.stringify(data);\n\n    return this.http.post(url, data);\n  }\n\n  public drawBtn(need) {\n    this.drawNeedle = need;\n    if (need) {\n      this.router.navigate([\"draw\"]);\n    } else {\n      localStorage.removeItem(\"drawImg\");\n    }\n  }\n\n  public parsePhone(phone): Array<string> {\n    let phones: Array<string> = [];\n    phone = phone.replace(/\\D+/g, \"\");\n\n    while (phone.length > 7) {\n      phone = this.normalizePhoneNumber(phone);\n      phones.push(phone.slice(\"\", 11));\n      phone = phone.slice(11);\n    }\n\n    return phones;\n  }\n\n  private normalizePhoneNumber(phone): string {\n    if (phone[0] !== \"8\" && phone[0] !== \"7\" && phone.length !== 11) {\n      phone = \"8\" + phone;\n    }\n    if (phone.length == 7 || phone.length == 10) {\n      phone = \"8\" + phone;\n    }\n    if (phone[0] !== \"8\" && phone.length == 11) {\n      phone = \"8\" + phone.slice(1);\n    }\n    return phone;\n  }\n\n  public phoneClick(action) {\n    this.orderPhones = this.parsePhone(this.phone);\n    let courierPhone = this.parsePhone(this.order.courier_phone)[0];\n\n    if (this.orderPhones.length == 1) {\n      this.selectedPhone = this.orderPhones[0];\n    }\n\n    switch (action) {\n      case \"init\":\n        this.callWindow = !this.callWindow;\n        break;\n      case \"phone\":\n        this.CL.callNumber(this.selectedPhone, false).then(() => { });\n        this.callWindow = false;\n        break;\n      case \"operator\":\n        if (this.network.type == 'none') {\n          this.phoneClick('phone');\n          return false;\n        }\n        if (this.selectedPhone && courierPhone) {\n          let url = \"orders\";\n          let data = {\n            action: \"send_phone\",\n            client_number: this.selectedPhone,\n            cur_number: courierPhone,\n          };\n          this.auth.sendPost(url, data).subscribe((resp) => {\n            console.log(\"call_subs\", resp);\n          });\n          this.auth.showError(9);\n          this.callWindow = false;\n        }\n        break;\n    }\n  }\n\n  public initOrder() {\n    this.storage.get('orders').then((orders: Array<Order>) => {\n      console.log('Список заказов из стоража', orders);\n    })\n    this.storage.get('orders').then((orders) => {\n      this.order = orders?.filter((order) => { return order.id.toString() == this.orderId })[0];\n      this.goods = this.order.goods;\n      this.address = this.order.client_address;\n      this.timeFrom = this.order.datetime_from;\n      this.timeTo = this.order.datetime_to;\n      this.phone = this.order.client_phone;\n      this.status = this.order.status_text;\n      this.status_id = Number(this.order.status_id);\n      this.client_status = this.order.client_status;\n      this.client_status_dt = this.order.client_status_dt;\n      this.vlog = this.order.vlog;\n      this.poruch = this.order.poruch;\n      (this.mass = this.order.mass), (this.amount = this.order.amount);\n      this.podrazd = this.order.Podrazd;\n      this.coords = [this.order.lt, this.order.lg];\n      this.setQuants();\n      this.ifPaid();\n      this.getBalnce();\n      this.getPayData();\n      this.initClientInfo();\n    });\n  }\n\n  public getClientState() {\n    var states = this.state$.client_states.getValue();\n    var state_id = this.order.client_state;\n\n    for (let i = 0; i < states.length; i++) {\n      if (states[i].id == state_id) {\n        return states[i].state;\n      }\n    }\n\n    return \"\";\n  }\n  //Заполняет массив с ценой товаров и их количеством(для частички)\n  public setQuants() {\n    var goods = this.order.goods;\n\n    for (var i = 0; i < goods.length; i++) {\n      let good = goods[i];\n      let code = good.Code;\n      let count = good.final_kol_vo ? good.final_kol_vo : good.kol_vo;\n      let quant = { amount: good.kol_vo, price: good.Price };\n      this.g_quants[code] = quant;\n    }\n  }\n\n  public changeQuant(code, action) {\n    var q: number = this.g_quants[code][\"amount\"];\n    var good = null;\n\n    for (var i = 0; i < this.order.goods.length; i++) {\n      if (this.order.goods[i].Code == code) {\n        good = this.order.goods[i];\n      }\n    }\n\n    if (action == \"plus\") {\n      var n_q = q + 1;\n\n      if (n_q > good.kol_vo) {\n        return false;\n      } else {\n        this.g_quants[code][\"amount\"] = n_q;\n      }\n    } else if (action == \"minus\") {\n      var n_q = q - 1;\n\n      if (n_q < 0) {\n        return false;\n      } else {\n        this.g_quants[code][\"amount\"] = n_q;\n      }\n    } else if (action == 'delete') {\n      this.g_quants[code][\"amount\"] = 0;\n    }\n    this.getSum();\n  }\n\n  public parseOrder(orders) {\n    if (this.state$.orders.getValue() == null) {\n      this.courier.getOrders();\n    }\n    for (var i = 0; i < orders.length; i++) {\n      if (orders[i].id == this.orderId) {\n        return orders[i];\n      }\n    }\n  }\n\n  public navBack() {\n    localStorage.removeItem(\"drawImg\");\n    this.router.navigate([\"/courier\"]);\n  }\n\n  public getStatus(): string {\n    return this.courier.getStatus(this.order);\n  }\n\n  public getBalnce() { }\n\n  public changeStatus() {\n    if (!this.changeWindow) {\n      this.changeWindow = true;\n    }\n  }\n\n  public close_window() {\n    this.changeWindow = false;\n  }\n\n  public selectStatus(id) {\n    this.selectedStatus = id;\n    if (id == 4 || id == 5) {\n      this.setQuants();\n      this.getSum();\n    }\n    if (id == 4) {\n      this.drawNeedle = false;\n    }\n  }\n\n\n  public sendPayCall(order: Order = this.order, newStatus = this.selectedStatus as number) {\n    if (this.network.type == 'none') {\n      //Если оффлайн\n      this.cache.getItem('syncRequests').then((syncRequests: Array<any>) => {\n        order = { ...{ phone_input: this.phone_input }, ...{ email_input: this.email_input }, ...{ quants: this.g_quants }, ...order, ...{ selectedPayment: this.selectedPayment }, ...{ selectedReason: this.selectedReason }, ...{ new_plan_date: this.new_plan_date }, ...{ commentText: this.commentText }, ...{ check: this.checkBase64Image } };\n        syncRequests && syncRequests.push({ order, newStatus });\n        this.cache.saveItem('syncRequests', syncRequests, 'delayedCalls').then(() => {\n          console.log(`sys:: Отложено изменение статуса на ${newStatus} для заказа ${order.client_id}`);\n          this.localModifyOrders(newStatus);\n          this.router.navigate(['courier']);\n        })\n      })\n    } else {\n      //Если онлайн\n      this.localModifyOrders(newStatus);\n      order = { ...{ phone_input: this.phone_input }, ...{ email_input: this.email_input }, ...{ quants: this.g_quants }, ...order, ...{ selectedPayment: this.selectedPayment }, ...{ selectedReason: this.selectedReason }, ...{ new_plan_date: this.new_plan_date }, ...{ commentText: this.commentText }, ...{ check: this.checkBase64Image } };\n      this.orderService.sendDelayedCall(order, newStatus);\n      this.router.navigate(['courier']);\n    }\n  }\n\n  public submitChange() {\n    let self = this;\n    this.storage.get('orders').then((orders) => {\n      orders?.map((order) => {\n        if (order.id.toString() == this.order.id) {\n          order.status_id = this.selectedStatus;\n          this.data.saveOrders(orders);\n          this.data.orders.next(orders);\n        }\n      });\n    })\n    let noSkip = true;\n    switch (this.selectedStatus) {\n      case 4:\n        if (this.selectedReason != null) {\n          let new_plan_date = new Date(this.new_plan_date);\n\n          this.courier\n            .changeStatus(\n              this.selectedStatus,\n              String(this.order.id),\n              undefined,\n              this.selectedReason,\n              null,\n              null,\n              new_plan_date.toLocaleDateString()\n            )\n            .subscribe((data: any) => {\n              if (data.success == \"true\") {\n                self.changeWindow = false;\n                self.state$.state.next(\"init\");\n                self.selectedPayment = \"1\";\n                self.selectedReason = null;\n                self.selectedStatus = null;\n                self.router.navigate([\"courier\"]);\n                self.state$.updateWayInfo.next(\"0\");\n              }\n              localStorage.removeItem(\"drawImg\");\n            });\n        }\n        break;\n      case 5:\n        if (this.selectedPayment !== '2') {\n          noSkip = false\n        }\n        this.sys.doOCR(this.checkBase64Image, noSkip).then((recognizedData) => {\n          let text = (this.commentText ? this.commentText : \"\");\n          this.courier\n            .changeStatus(\n              this.selectedStatus,\n              String(this.order.id),\n              text,\n              undefined,\n              undefined,\n              this.selectedPayment,\n              '',\n              this.checkBase64Image,\n              recognizedData\n            )\n            .subscribe((data: any) => {\n              if (data.success == \"true\") {\n                self.changeWindow = false;\n                self.state$.state.next(\"init\");\n                self.selectedPayment = \"1\";\n                self.selectedReason = null;\n                self.selectedStatus = null;\n                if (!self.pay_access) {\n                  self.router.navigate([\"courier\"]);\n                }\n                self.initOrder();\n                self.state$.updateWayInfo.next(\"0\");\n              }\n              localStorage.removeItem(\"drawImg\");\n            });\n        })\n        break;\n      case 6:\n\n        if (this.selectedPayment !== '2') {\n          noSkip = false\n        }\n        this.sys.doOCR(this.checkBase64Image, noSkip).then((recognizedData) => {\n          this.courier\n            .changeStatus(\n              this.selectedStatus,\n              String(this.order.id),\n              undefined,\n              undefined,\n              this.g_quants,\n              this.selectedPayment,\n              '',\n              this.checkBase64Image,\n              recognizedData\n            )\n            .subscribe((data: any | null) => {\n              if (data?.success == \"true\") {\n                self.changeWindow = false;\n                self.state$.state.next(\"init\");\n                self.selectedPayment = \"1\";\n                self.selectedReason = null;\n                self.selectedStatus = null;\n                if (!self.pay_access) {\n                  self.router.navigate([\"courier\"]);\n                }\n                self.initOrder();\n                self.state$.updateWayInfo.next(\"0\");\n              } else {\n                this.sys.presentToast(\n                  \"Нет товаров в заказе\",\n                  \"danger\",\n                  \"Частичная доставка невозможна\"\n                );\n              }\n              localStorage.removeItem(\"drawImg\");\n            });\n        })\n        break;\n    }\n  }\n\n  public getSum() {\n    if (this.order) {\n      let price: number = 0;\n      let quants = this.g_quants;\n      for (let code in quants) {\n        price += quants[code][\"price\"] * quants[code][\"amount\"];\n      }\n\n      this.order.rur = price;\n    }\n  }\n\n  //подсчитывает сумму заказа\n  public getPrice(order) {\n    if (order) {\n      let price: number = 0;\n      for (let i = 0; i < order.goods.length; i++) {\n        let good = order.goods[i];\n        price += Number(good.Price) * Number(good.kol_vo);\n      }\n      return price;\n    }\n  }\n\n  public selectPayment(item) {\n    this.selectedPayment = item;\n  }\n\n  public sendPay() {\n    let goods = this.order.goods;\n    let quants = this.g_quants;\n    let callback_url =\n      this.sys.proxy + \"https://mobile.postsrvs.ru/mobile/pay_callback.php\";\n    let products = [];\n\n    for (let code in quants) {\n      if (quants[code][\"amount\"] > 0) {\n        for (let i = 0; i < goods.length; i++) {\n          if (goods[i][\"Code\"] == code) {\n            let good_name = goods[i][\"Name\"];\n            let good_amount = quants[code][\"amount\"];\n            let good_price = Math.round(quants[code][\"price\"] * 100) / 100;\n            let pos = {\n              name: good_name,\n              price: good_price,\n              quantity: good_amount,\n            };\n            products.push(pos);\n          }\n        }\n      }\n    }\n\n    var purchase = { products: products };\n    console.log(\"goods_description\\n\", purchase);\n    var self = this;\n\n    if (this.pay_access) {\n      let api_key = this.pay_access_data[\"api_key\"];\n      let login = this.pay_access_data[\"login\"];\n      let cashier = this.pay_access_data[\"cashier_name\"];\n      let phone;\n\n      let order_data = {\n        apikey: String(this.pay_access_data.api_key),\n        login: String(this.pay_access_data.phone),\n        cashier_name:\n          String(this.pay_access_data.name) +\n          String(this.pay_access_data.phone),\n        purchase: purchase,\n        callback_url: callback_url,\n        mode: \"email\",\n        customer_email: this.email_input,\n        customer_phone: this.phone_input,\n      };\n      if (self.selectedPayment == \"2\") {\n        order_data[\"card_amount\"] = \"#\";\n      } else {\n        order_data[\"cash_amount\"] = \"#\";\n      }\n\n      if (this.phone_input != \"\") {\n        order_data[\"customer_phone\"] = this.phone_input;\n      }\n\n      self.send_api_data(order_data);\n    }\n  }\n\n  //Получаем api key & login\n  public getPayData() {\n\n    let url = \"pay_order\";\n    let data = { action: \"getData\", orderId: this.clientId };\n    let self = this;\n    if (navigator.onLine) {\n      this.auth.sendPost(url, data).subscribe((res: any) => {\n        console.log(\"GET_PAY_DATA\", res);\n        if (res.success == \"true\") {\n          self.pay_access = true;\n          self.pay_access_data = res;\n        } else {\n          self.pay_access = false;\n        }\n      });\n    } else {\n      self.pay_access = false;\n    }\n  }\n\n  public send_api_data(api_data) {\n    let url = \"pay_order\";\n    let self = this;\n    this.order.rur = 0;\n\n    api_data.purchase.products.forEach((product) => {\n      this.order.rur += product.price * product.quantity;\n    });\n\n    var data = {\n      action: \"sendPay\",\n      orderData: api_data,\n      orderId: this.order.id,\n    };\n    if (navigator.onLine) {\n      this.auth.sendPost(url, data).subscribe((res: any) => {\n        self.submitChange();\n        self.checkPayment();\n        self.hide_status = true;\n      });\n    } else {\n      let requests = [];\n      this.cache.getItem('requests').then((req) => {\n        if (req !== undefined) {\n          requests = req;\n        }\n        requests.push({ url: url, data: data });\n        this.cache.saveItem('requests', requests);\n\n        self.submitChange();\n        self.checkPayment();\n        self.hide_status = true;\n      })\n\n    }\n  }\n\n\n  public checkPayment() {\n    var self = this;\n    this.state$.interval_1ss.pipe(takeUntil(this.$codeStop)).subscribe(() => {\n      self.ifPaid();\n      console.log(\"paid_iter\");\n    });\n  }\n\n  public ifPaid() {\n    var url = \"pay_order\";\n    var data = { action: \"checkPaid\", orderId: this.order.id };\n    var self = this;\n\n    this.auth.sendPost(url, data).subscribe((data) => {\n      if (data.success == \"true\" && data.barcode != null) {\n        self.barcode_flag = true;\n        self.barcode_url = data.barcode_url;\n        self.barcode = data.barcode;\n        self.$codeStop.next();\n        self.hide_status = true;\n      }\n    });\n  }\n\n  public enterPhone() {\n    if (this.showPhone) {\n      this.showPhone = false;\n      this.show_email = false;\n    } else {\n      this.showPhone = true;\n      this.show_email = true;\n    }\n  }\n\n\n\n  public initClientInfo() {\n    let mail_exp = /(?:([\\s.,]{1}))([a-z0-9_-]+\\.)*[a-z0-9_-]+@[a-z0-9_-]+(\\.[a-z0-9_-]+)*\\.[a-z]{2,6}/gm;\n    let infoStr = this.phone;\n    let mail = mail_exp.exec(infoStr);\n\n    if (mail != null) {\n      this.email_input = mail[0];\n    } else {\n      this.show_email = true;\n    }\n  }\n\n  public intentStart() {\n    this.state$.intentStart(this.coords);\n  }\n\n  public showRoute() {\n    this.sysMap.showRoute(this.order);\n\n  }\n\n  public doneOrder(data?) {\n    let drawedImg = localStorage.drawImg;\n    if (this.drawNeedle && !drawedImg) {\n      this.drawBtn(this.drawNeedle);\n    } else {\n      if (this.selectedPayment == '2') {\n        this.sys.checkPhoto().then((imageData) => {\n          this.checkBase64Image = 'data:image/jpeg;base64,' + imageData;\n          this.sendPayCall();\n        });\n      } else {\n        this.sendPayCall();\n      }\n\n    }\n  }\n\n  public saveNote() {\n    localStorage.setItem(this.orderId, this.note);\n    this.sysMap.infoUpdated.next();\n  }\n\n  public tapBlock() {\n    this.openCompany = !this.openCompany;\n  }\n\n  public localModifyOrders(newStatus: number) {\n    let meta: Meta = {\n      label: 'localChanges'\n    };\n    this.storage.get('orders').then((orders) => {\n      orders?.map((order: Order) => {\n        if (order.id.toString() == this.order.id.toString()) {\n          order.status_id = newStatus;\n          this.data.saveOrders(orders).then(() => this.sysMap.infoUpdated.next(meta));\n          this.data.orders.next(orders);\n        }\n      });\n    })\n  }\n\n  public scanReturned() {\n    this.bs.scan().then((data) => {\n      const url = this.sys.proxy + 'https://mobile.postsrvs.ru/mobile/orders';\n      let data1 = {\n        \"orderId\": this.orderId,\n        \"box_barcode\": data.text,\n        \"action\": \"get_box\",\n        \"uuid\": this.device.uuid\n      };\n      this.http.post(url, data1).subscribe(res => {\n        console.log(`sys:: ответ скана возврата: ${res}`);\n        this.changeQuant(res[0], 'delete')\n      })\n    })\n  }\n\n  async presentNotDeliveredModal() {\n    const modal = await this.modalController.create({\n      component: NotDeliveredComponent,\n      cssClass: 'done-order-modal',\n      componentProps: {\n        reasons: this.reasons\n      },\n      showBackdrop: true\n    });\n    await modal.present();\n    const details = await modal.onDidDismiss();\n    console.log('sys:: dismiss details: ', details);\n    this.selectedReason = details.data.selectedReason;\n    this.commentText = details.data.commentText;\n    details.data && this.doneOrder();\n  }\n\n  async presentDeliveredModal() {\n    const modal = await this.modalController.create({\n      component: DeliveredComponent,\n      cssClass: 'done-order-modal',\n      componentProps: {\n        goods: this.goods\n      },\n      showBackdrop: true\n    });\n    await modal.present();\n    const details = await modal.onDidDismiss();\n    console.log('sys:: dismiss details: ', details);\n    this.drawNeedle = details.data.drawNeedle;\n    this.selectedPayment = details.data.selectedPayment;\n    this.email_input = details.data.email_input;\n    this.phone_input = details.data.phone_input;\n    this.commentText = details.data.commentText;\n    if (details.data) {\n      this.doneOrder();\n    }\n\n  }\n}\n"]}