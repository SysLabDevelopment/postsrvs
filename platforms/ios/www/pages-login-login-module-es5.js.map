{"version":3,"sources":["webpack:///src/app/pages/login/login.module.ts","webpack:///src/app/pages/login/login.page.ts","webpack:///src/app/pages/login/login.page.html"],"names":["routes","path","component","LoginPageModule","forRoot","forChild","imports","declarations","LoginPage","auth","router","alert","plt","http","state$","AP","courier","settings","sys","sysMap","pl_window","error_phone","phone","loader","auth_step","code","resend_dis","dis_timer","$stopTimer","self","ready","then","readySource","console","log","requestPermission","PERMISSION","ACCESS_FINE_LOCATION","checkAuth","subscribe","data","success","setUser","sync_id","getSettings","navigate","initLogin","localStorage","debug","isDebug","scanData","id","text","slice","setItem","a_data","login","showError","length","sendPhone","url","proxy","sendPost","res","authStep","showLoginError","err","startTimer","httpOptions","headers","post","user","base","err_n","interval_1ss","pipe","next","scanAuth","phoneAuth","height","display","selector","templateUrl","styleUrls","animations"],"mappings":"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","file":"pages-login-login-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\nimport {NgxMaskModule} from 'ngx-mask'\nimport { IonicModule } from '@ionic/angular';\nimport {IconsModule} from '../../icons/icons.module'\n\nimport { LoginPage } from './login.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LoginPage\n  }\n];\n\n@NgModule({\n  imports: [\n    IconsModule,\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    NgxMaskModule.forRoot(),\n    RouterModule.forChild(routes)\n  ],\n  declarations: [LoginPage]\n})\nexport class LoginPageModule {}\n","import {\n  animate, state,\n  style,\n\n  transition, trigger\n} from '@angular/animations';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AndroidPermissions } from '@ionic-native/android-permissions/ngx';\nimport { AlertController, Platform } from '@ionic/angular';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { MapService } from 'src/app/services/sys/map.service';\nimport { AuthService } from '../../services/auth.service';\nimport { CourierService } from '../../services/courier.service';\nimport { SettingsService } from '../../services/settings.service';\nimport { StateService } from '../../services/state.service';\nimport { SysService } from '../../services/sys.service';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.page.html',\n  styleUrls: ['./login.page.scss'],\n  animations: [\n    trigger('openClose', [\n      // ...\n      state('open', style({\n        height: '264px',\n      })),\n      state('closed', style({\n        height: '50px',\n      })),\n      transition('open => closed', [\n        animate('0.5s')\n      ]),\n      transition('closed => open', [\n        animate('0.5s')\n      ]),\n    ]),\n    trigger('openClose1', [\n      // ...\n      state('open', style({\n        height: '50px',\n      })),\n      state('closed', style({\n        height: '0px',\n        display: 'none'\n      })),\n      transition('open => closed', [\n        animate('0.5s')\n      ]),\n      transition('closed => open', [\n        animate('0.5s')\n      ]),\n    ])\n  ]\n})\nexport class LoginPage implements OnInit {\n\n  public pl_window: boolean = false;\n  public error_phone: boolean = false;\n  public phone = '';\n  public loader: boolean = false;\n  public auth_step: boolean = false;\n  public code: string = null;\n  public resend_dis: boolean = false;\n  public dis_timer: number = null;\n  public $stopTimer: Subject<any> = new Subject();\n  constructor(private auth: AuthService,\n    private router: Router,\n    private alert: AlertController,\n    private plt: Platform,\n    private http: HttpClient,\n    public state$: StateService,\n    private AP: AndroidPermissions,\n    public courier: CourierService,\n    public settings: SettingsService,\n    public sys: SysService,\n    public sysMap: MapService\n  ) {\n    let self = this;\n\n    //проверяет авторизован ли пользователь на сервере\n\n    this.plt.ready().then((readySource) => {\n      console.log('sys:: платформа готова:', readySource);\n      if (readySource == 'android') {\n        this.AP.requestPermission(this.AP.PERMISSION.ACCESS_FINE_LOCATION);\n      }\n      this.auth.checkAuth().subscribe((data: any) => {\n        if (data.success == 'true') {\n          this.auth.setUser(data.sync_id);\n          this.settings.getSettings(data.sync_id);\n          self.router.navigate(['map']);\n          self.auth.initLogin();\n        } else {\n        }\n      })\n\n    })\n  }\n\n  ngOnInit() {\n\n    if (localStorage.debug == 'true') {\n      this.auth.isDebug = true;\n    }\n\n  }\n\n  public scanAuth() {\n    let self = this;\n\n    this.auth.scanData().then((data) => {\n      let id = data.text.slice(0, -4);\n      localStorage.setItem('cId', id);\n      let a_data = {\n        'action': 'auth',\n        'barcode': data.text,\n        // 'barcode': '33dbcda2db5311e39760309e88d17f08,3431',\n      };\n      self.auth.login(a_data).subscribe((data: any) => {\n        if (data.success == \"true\") {\n          self.auth.initLogin();\n          this.auth.setUser(data.sync_id);\n          this.settings.getSettings(data.sync_id);\n          self.router.navigate(['map']);\n\n        } else {\n          self.auth.showError(1);\n        }\n      });\n    });\n  }\n\n\n  public phoneAuth() {\n    if (!this.auth_step) {\n      this.pl_window = !this.pl_window;\n    }\n  }\n\n  public enterPhone() {\n    if (this.phone && this.phone.length > 9) {\n      this.loader = true;\n      this.sendPhone();\n    } else {\n      this.error_phone = true;\n    }\n\n  }\n\n  public changePhone() {\n    this.error_phone = false;\n  }\n\n  public sendPhone() {\n    const url = this.sys.proxy + \"https://mok.flexcore.ru/client/registerP/\";\n    const data = \"action=registerP&phone=8\" + this.phone + \"&type=courier\";\n    var self = this;\n    this.sendPost(url, data).subscribe((res: any) => {\n      if (res.success == 'true') {\n        self.authStep();\n      } else {\n        this.showLoginError(4);\n      }\n    }, (err) => {\n      this.showLoginError(3);\n    })\n    this.startTimer();\n  }\n\n  public sendPost(url: string, data: any) {\n    console.log('send_data', data);\n    const httpOptions = {\n      headers: new HttpHeaders({\n        'Access-Control-Allow-Origin': '*',\n        'Content-type': 'application/x-www-form-urlencoded',\n        'Access-Control-Allow-Headers': '*'\n      })\n    };\n\n    return this.http.post(url, data, httpOptions);\n  }\n\n  public authStep() {\n    this.auth_step = true;\n    this.loader = false;\n  }\n\n  public enterCode() {\n    const url = this.sys.proxy + \"https://mok.flexcore.ru/courier/authP/\";\n    var data = \"action=authP&phone=8\" + this.phone + \"&code=\" + this.code + \"&type=courier\";\n\n    var self = this;\n    this.sendPost(url, data).subscribe((res: any) => {\n      console.log('sendCode', res);\n\n      if (res.success == 'true') {\n        self.login(res.user);\n      } else {\n        self.error_phone = true;\n      }\n    })\n  }\n\n  public login(courier: string) {\n    let base = \"33dbcda2db5311e39760309e88d17f08,\" + courier;\n    localStorage.setItem('cId', courier);\n    var self = this;\n    let a_data = {\n      'action': 'auth',\n      'barcode': base,\n    };\n\n    this.auth.login(a_data).subscribe((data: any) => {\n\n      if (data.success == \"true\") {\n        this.auth.setUser(data.sync_id);\n        this.settings.getSettings(data.sync_id);\n        self.router.navigate(['map']);\n        self.auth.initLogin();\n      } else {\n        self.auth.showError(1);\n      }\n    });\n  }\n\n  public showLoginError(err_n: number) {\n    switch (err_n) {\n      case 3:\n        this.loader = false;\n        this.phone = null;\n        this.pl_window = false;\n        this.auth.showError(err_n);\n        break;\n      case 4:\n        this.loader = false;\n        this.phone = null;\n        this.pl_window = false;\n        this.auth.showError(err_n);\n        break;\n    }\n\n  }\n\n  public startTimer() {\n    if (this.resend_dis) {\n      return false;\n    }\n    this.resend_dis = true;\n    this.dis_timer = 30;\n    var self = this;\n\n    this.state$.interval_1ss.pipe(takeUntil(this.$stopTimer)).subscribe(() => {\n      self.dis_timer--;\n      if (self.dis_timer == 0) {\n        self.dis_timer = null;\n        self.$stopTimer.next(null);\n        self.resend_dis = false;\n      }\n    });\n  }\n\n  public reEnterPhone() {\n    if (this.resend_dis) {\n      return false;\n    }\n    this.sendPhone();\n  }\n\n  public changeCode() { }\n}\n","<ion-content>\n  <div class=\"lg-wrp\">\n    <div class=\"lg-btn\">\n      <button class=\"lg-login\" [@openClose1]=\"auth_step ? 'closed' : 'open'\" (click)=\"scanAuth()\">\n        Войти по QR-коду\n      </button>\n      <button class=\"lg-login login-phone\" [ngClass]=\"{'btn-open' : pl_window}\"\n        [@openClose]=\"pl_window ? 'open' : 'closed'\">\n        <div class=\"btn-wrp\">\n          <div class=\"btn-title\" (click)=\"phoneAuth()\">Войти по номеру телефона</div>\n          <div class=\"btn-body phone-b\" *ngIf=\"!auth_step\">\n            <div class=\"bi-title\">Введите номер</div>\n            <div class=\"bi-inp\">\n              <span class=\"error-phone\" *ngIf=\"error_phone\">Введите корректный телефон</span>\n              <input type=\"tel\" prefix=\"+7 \" mask=\"(000) 000 00 00\" class=\"phone-inp\" [showMaskTyped]=\"true\"\n                [(ngModel)]=\"phone\" (input)=\"changePhone()\" />\n              <button class=\"enter-phone\" (click)=\"enterPhone()\">Отправить</button>\n            </div>\n            <div class=\"sh-icons\" *ngIf=\"loader\">\n              <i-feather name=\"loader\"></i-feather>\n            </div>\n          </div>\n          <div class=\"btn-body code-b\" *ngIf=\"auth_step\">\n            <div class=\"bi-title\">Введите код</div>\n            <div class=\"bi-inp\">\n              <span class=\"error-phone\" *ngIf=\"error_phone\">Неверный код</span>\n              <input type=\"tel\" mask=\"00-00\" class=\"phone-inp\" [showMaskTyped]=\"true\" [(ngModel)]=\"code\"\n                (input)=\"changePhone()\" />\n              <button class=\"enter-phone\" (click)=\"enterCode()\">Отправить</button>\n              <button class=\"enter-phone\" [ngClass]=\"{'btn-resend' : resend_dis}\" (click)=\"reEnterPhone()\">\n                Отправить повторно {{dis_timer}}\n              </button>\n            </div>\n            <div class=\"sh-icons\" *ngIf=\"loader\">\n              <i-feather name=\"loader\"></i-feather>\n            </div>\n          </div>\n        </div>\n      </button>\n    </div>\n  </div>\n</ion-content>"]}