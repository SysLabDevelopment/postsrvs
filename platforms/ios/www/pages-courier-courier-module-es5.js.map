{"version":3,"sources":["webpack:///src/app/pages/courier/courier.module.ts","webpack:///src/app/pages/courier/courier.page.html","webpack:///src/app/pages/courier/courier.page.ts"],"names":["routes","path","component","CourierPageModule","provide","useFactory","forChild","imports","declarations","providers","$event","stopPropagation","CourierPage","courier","router","state$","auth","bs","vbr","settings","sys","data","popoverController","map","orders","statuses","selectedTab","ordersInit","loader","local_stop$","localcheck","g_done","g_process","g_fail","lvl_ind","width","btn_go","notification","dragStarted","subBtnCond","scanView","scan_process","find_order","isWorkEnded","searchString","slicer","howSlice","self","initContent","position","getValue","startRoute","state","pipe","subscribe","a","initConditions","ord","asObservable","prepareOrdersList","app_mode","getMode","confirmed","Drop_L","autoScrollDisabled","DragItems","changes","r","forEach","DragItem","dragStartDelay","touch","mouse","checkout","rules","storeCheckMode","checkState","localStorage","check","appMode","manual_route","count_orders","getScanMode","findOrder","scanInput","res","success","sumbitOrder","order_id","re_s","console","log","submitOrder","showError","order","confirm","setTimeout","scanSearch","scanInputStart","sInput","nativeElement","focus","scan","then","text","way","Array","Number","status_id","push","id","old_way","next","orders_page_check","changeRouteMode","vibrate","orders_data","getStatus","navigate","tab","index","obj","status","ordersInfo","i","length","String","start","stop","checkAuth","sendStartRoute","sync_id","cid","url","lt","lg","sendPost","result","selectOrder","endWork","presentToast","error","message","event","getApiData","add","target","complete","ids","value","orders_c","filter","includes","client_address","toLowerCase","client_fio","client_id","slice","show","typeRoute","ev","create","translucent","cssClass","popover","popoverHelp","present","showRoute","previousIndex","currentIndex","popoverNote","showHelp","doRefresh","segmentChanged","height","selector","templateUrl","styleUrls","animations","reorderGroup"],"mappings":"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","file":"pages-courier-courier-module-es5.js","sourcesContent":["import { DragDropModule } from '@angular/cdk/drag-drop';\nimport { ScrollingModule } from '@angular/cdk/scrolling';\nimport { CommonModule, registerLocaleData } from '@angular/common';\nimport localeRu from '@angular/common/locales/ru';\nimport { LOCALE_ID, NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule, Routes } from '@angular/router';\nimport { IonicModule } from '@ionic/angular';\nimport { IconsModule } from '../../icons/icons.module';\nimport { CourierPage } from './courier.page';\n\nregisterLocaleData(localeRu, 'ru');\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CourierPage\n  }\n];\n\n@NgModule({\n  imports: [\n    IconsModule,\n    CommonModule,\n    FormsModule,\n    DragDropModule,\n    IonicModule,\n    ScrollingModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [CourierPage],\n  providers: [\n    { provide: LOCALE_ID, useFactory: () => 'ru' }\n  ]\n})\nexport class CourierPageModule { }\n","<ion-header>\n  <ion-toolbar class='toolbar'>\n    <ion-buttons slot=\"start\">\n      <ion-button (click)=\"findOrder()\">\n        <i-feather name=\"search\" slot='start'></i-feather>\n      </ion-button>\n      <ion-button *ngIf=\"auth.getGuessMode()\">\n        <i>G</i>\n      </ion-button>\n    </ion-buttons>\n    <ion-title>Мои заказы</ion-title>\n    <ion-title size=\"small\" color=\"dark\">{{state$.filial}}</ion-title>\n    <ion-buttons slot=\"primary\">\n      <ion-button *ngIf=\"subBtnCond\" (click)=\"submitOrder()\">\n        <i-feather name=\"box\"></i-feather>\n      </ion-button>\n      <ion-button *ngIf=\"courier.sortOrders?.g_process == 0 && !isWorkEnded\" (click)=\"endWork()\">\n        <i-feather name=\"check-square\"></i-feather>\n      </ion-button>\n      <ion-button (click)=\"showHelp($event)\">\n        <ion-icon slot=\"icon-only\" name=\"help-circle-outline\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content>\n  <ion-refresher slot=\"fixed\" (ionRefresh)=\"doRefresh($event)\">\n    <ion-refresher-content pullingIcon=\"arrow-dropdown\" pullingText=\"Потяните, чтобы обновить\"\n      refreshingSpinner=\"bubbles\" refreshingText=\"Обновление...\">\n    </ion-refresher-content>\n  </ion-refresher>\n\n  <div class=\"c-wrp\" [ngClass]=\"{  'm_wrp' : auth.getMode() == 'fullHand' || auth.getMode() == 'hand'}\">\n    <ion-segment (ionChange)=\"segmentChanged($event)\" value='1' style=\"height: 45px\">\n      <ion-segment-button value=\"1\">\n        <ion-label>В работе</ion-label>\n      </ion-segment-button>\n      <ion-segment-button value=\"4\">\n        <ion-label>Доставлено</ion-label>\n      </ion-segment-button>\n      <ion-segment-button value=\"6\">\n        <ion-label>Не доставлено</ion-label>\n      </ion-segment-button>\n    </ion-segment>\n    <div class=\"c-body\" *ngIf=\"ordersInit && !auth.getGuessMode()\">\n      <ion-searchbar placeholder=\"Поиск по заказам\" inputmode=\"text\" (ionChange)=\"onSearchChange($event)\"\n        [debounce]=\"250\" [(ngModel)]=\"searchString\" animated></ion-searchbar>\n\n      <cdk-virtual-scroll-viewport cdkDropList (cdkDropListDropped)=\"drop($event)\" itemSize=\"50\"\n        style=\"height: 100%; width: 100%; min-height: 50vh;\">\n        <ion-item *ngFor=\"let order of orders_c | async\" [ngClass]=\"{\n         overdue: order.overdue == '1' || order.required == true\n        }\" (click)=\"selectOrder(order.id)\" cdkDrag [cdkDragStartDelay]=\"500\">\n\n          <ion-label [@openClose]=\"order.show ? 'open' : 'closed'\">\n\n            <div class='title'>\n              <span>\n                <span class='client-id'> {{order.client_id}}</span>\n                <span> ({{order.company}})</span>\n              </span>\n              <span class='client-id'>\n                <span *ngIf=\"order.datetime_from\">c {{ order.datetime_from | date: 'H:mm':'ru' }} </span>\n                <span *ngIf=\"order.datetime_to\">до {{ order.datetime_to | date: 'H:mm':'ru' }}</span>\n              </span>\n            </div>\n            <div class='addr'>{{order.client_address}}</div>\n            <div class='name'>{{order.client_fio}}</div>\n            <div class='actions' *ngIf='order.show'>\n              <ion-button fill=\"solid\" size='default' (click)=\"showRoute(order); $event.stopPropagation()\">\n                <ion-icon slot=\"start\" src='../../../assets/mdi-light_note-plus.svg'></ion-icon>\n                Заметки\n              </ion-button>\n              <ion-button fill=\"solid\" size='default' (click)=\"showRoute(order); $event.stopPropagation()\">\n                <ion-icon slot=\"start\" name=\"location-outline\"></ion-icon>\n                Маршрут\n              </ion-button>\n              <ion-button fill=\"solid\" size='default'>\n                <ion-icon slot=\"start\" name=\"call-outline\"></ion-icon>\n                Позвонить\n              </ion-button>\n            </div>\n          </ion-label>\n\n\n          <ion-icon name=\"ellipsis-vertical\" slot='start'></ion-icon>\n\n          <div class=\"actions-button\" (click)=\"order.show = !order.show; $event.stopPropagation()\">\n            <ion-icon src='../../../assets/actions-arrows.svg' [ngClass]=\"{turned: order.show == true }\"></ion-icon>\n          </div>\n        </ion-item>\n      </cdk-virtual-scroll-viewport>\n    </div>\n\n    <div class=\"start-route\"\n      *ngIf=\"ordersInit && state$.orders_data != [] && state$.orders_data !== null && auth.checkState == 'checkedOut'\">\n      <button class=\"satrt-r-btn\" *ngIf=\"!btn_go && !this.state$.manual_route && auth.routingModeAuto\"\n        (click)=\"startRoute()\">\n        Начать маршрут\n      </button>\n      <button class=\"satrt-r-btn sr-stop\" *ngIf=\"btn_go && !this.state$.manual_route\" (click)=\"stopRoute()\">\n        Остановить маршрут\n      </button>\n      <button class=\"satrt-r-btn find-o-btn\" *ngIf=\"auth.getMode() == 'auto' || auth.getMode() == 'auto_wo'\"\n        [ngClass]=\"{  'manual_btn' : this.state$.manual_route}\" (click)=\"manualRoute()\">\n        <span *ngIf=\"this.state$.manual_route\">Автоматический режим</span>\n        <span *ngIf=\"!this.state$.manual_route\">Ручной режим</span>\n      </button>\n    </div>\n    <div class=\"scanWindow\" *ngIf=\"scanView\">\n      <div class=\"sw-wrp\">\n        <div class=\"sw-title\">Просканируйте штрихкод</div>\n        <input #sInput class=\"ionInp\" (change)=\"scanInputChange()\" [(ngModel)]=\"scanInput\" autofocus />\n      </div>\n    </div>\n  </div>\n\n  <div class=\"shirm\" *ngIf=\"loader\">\n    <ion-spinner name=\"lines-small\"></ion-spinner>\n  </div>\n</ion-content>","import {\n  animate,\n  state,\n  style,\n  transition,\n  trigger\n} from '@angular/animations';\nimport { CdkDrag, CdkDragDrop, CdkDropList, moveItemInArray } from '@angular/cdk/drag-drop';\nimport { Component, ElementRef, OnInit, QueryList, ViewChild, ViewChildren } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BarcodeScanner } from '@ionic-native/barcode-scanner/ngx';\nimport { Vibration } from '@ionic-native/vibration/ngx';\nimport { IonReorderGroup, PopoverController } from \"@ionic/angular\";\nimport { Observable, Subject } from 'rxjs';\nimport { map, takeUntil } from 'rxjs/operators';\nimport { MapService } from 'src/app/services/sys/map.service';\nimport { HelpComponent } from '../../components/help/help.component';\nimport { AuthService } from '../../services/auth.service';\nimport { CourierService } from '../../services/courier.service';\nimport { SettingsService } from '../../services/settings.service';\nimport { StateService } from '../../services/state.service';\nimport { SysService } from '../../services/sys.service';\nimport { DataService } from '../../services/sys/data.service';\n\n\n@Component({\n  selector: 'app-courier',\n  templateUrl: './courier.page.html',\n  styleUrls: ['./courier.page.scss'],\n  animations: [\n    trigger('openClose', [\n      // ...\n      state('open', style({\n        height: '125px',\n      })),\n      state('closed', style({\n        height: '80px',\n      })),\n      transition('open => closed', [\n        animate('0.5s')\n      ]),\n      transition('closed => open', [\n        animate('0.5s')\n      ]),\n    ])\n  ]\n})\nexport class CourierPage implements OnInit {\n  @ViewChild(IonReorderGroup) reorderGroup: IonReorderGroup;\n  @ViewChild('sInput') public sInput: ElementRef;\n  @ViewChild(CdkDropList, { static: false })\n  Drop_L: CdkDropList;\n  @ViewChildren(CdkDrag)\n  DragItems: QueryList<CdkDrag>;\n\n  public orders: any = null;\n  public statuses: any = null;\n  public selectedTab = 1;\n  public ordersInit: boolean = false;\n  public loader: boolean = false;\n  public local_stop$: Subject<any> = new Subject();\n  public localcheck: boolean = false;\n  public g_done = 0;\n  public g_process = 0;\n  public g_fail = 0;\n  public lvl_ind = { width: '0%' };\n  public btn_go: boolean = false;\n  public notification = null;\n  public dragStarted: boolean = false;\n  public subBtnCond: boolean = true;\n  public scanView: boolean = false;\n  public scanInput;\n  public scan_process = false;\n  public find_order: boolean = false;\n  public isWorkEnded: boolean = false;\n  public searchString = '';\n  private ord: Observable<any[]>;\n  public orders_c: Observable<any>;\n  public slicer: number = this.howSlice();\n\n\n  constructor(public courier: CourierService,\n    private router: Router,\n    public state$: StateService,\n    public auth: AuthService,\n    private bs: BarcodeScanner,\n    private vbr: Vibration,\n    private settings: SettingsService,\n    private sys: SysService,\n    private data: DataService,\n    public popoverController: PopoverController,\n    private map: MapService\n  ) {\n    let self = this;\n\n    this.initContent();\n    if (this.state$.position.getValue() != null) {\n      this.startRoute(false);\n    }\n\n\n    this.state$.state.pipe(takeUntil(this.local_stop$)).subscribe((state) => {\n      const a = state;\n      if (state == 'orders_init') {\n        self.initContent();\n      }\n    })\n    this.initConditions();\n    this.ord = this.data.orders.asObservable();\n    this.prepareOrdersList();\n\n  }\n\n  public initConditions() {\n    let app_mode = this.auth.getMode();\n    switch (app_mode) {\n      case 'fullAuto':\n        if (!this.state$.confirmed) this.subBtnCond = true;;\n        break;\n      case 'auto':\n        this.subBtnCond = false;\n        break;\n      case 'fullHand':\n        if (!this.state$.confirmed) this.subBtnCond = true;\n        break;\n      case 'hand':\n        this.subBtnCond = false;\n        break;\n    }\n  }\n\n  ngAfterViewChecked() {\n    this.Drop_L.autoScrollDisabled = false;\n    this.DragItems.changes.subscribe((r) => {\n      this.DragItems.forEach(DragItem => {\n        DragItem.dragStartDelay = {\n          touch: 500,\n          mouse: 100\n        }\n\n      })\n    });\n  }\n\n  ngOnInit() {\n    this.settings.checkout = !!(this.settings.rules.storeCheckMode - 0);\n    if (!this.settings.checkout) {\n      this.auth.checkState = 'checkedOut'\n    } else {\n      this.auth.checkState = 'checked' + localStorage.check\n    }\n    if (this.settings.rules.appMode == 'hand') {\n      this.state$.manual_route = true\n    }\n    this.data.orders.subscribe((orders) => {\n      this.courier.count_orders(orders)\n    })\n  }\n\n  public scanInputStart() {\n    let self = this;\n    this.scanView = !this.scanView;\n    this.loader = true;\n    if (this.auth.getScanMode() == 'scan') {\n      self.courier.findOrder(this.scanInput).subscribe((res) => {\n        self.scanInput = null;\n        if (res.success == 'true') {\n          self.courier.sumbitOrder(res.order_id).subscribe((re_s) => {\n            console.log('courier_page sbo resp', re_s);\n            if (re_s) {\n              self.submitOrder();\n            } else {\n              self.scanView = false;\n            }\n            self.loader = false;\n          });\n        } else {\n          self.auth.showError(2);\n          self.loader = false;\n          self.scanView = false;\n        }\n        self.state$.confirmed = true;\n        self.orders.forEach(order => {\n          if (order.confirm == '0') {\n            self.state$.confirmed = false;\n          }\n        });\n      })\n    } else {\n      self.loader = false;\n    }\n    this.scan_process = false;\n  }\n\n  public scanInputChange() {\n    console.log('inputData', this.scanInput);\n    let self = this;\n    if (this.scan_process) return false;\n    this.scan_process = true;\n    if (this.find_order) {\n      setTimeout(function () {\n        self.scanSearch();\n      }, 1500)\n    } else {\n      setTimeout(function () {\n        self.scanInputStart();\n      }, 1500)\n    }\n  }\n\n  public submitOrder() {\n    var self = this;\n    console.log('SUBMIT_ORDER_CALL');\n    if (this.auth.getScanMode() == 'scan') {\n      this.scanView = !this.scanView;\n      setTimeout(function () {\n        self.sInput.nativeElement.focus();\n      }, 500);\n      return false\n    }\n    this.bs.scan().then((data) => {\n      console.log('SCAN_RETURN_DATA', data);\n      if (data.text != \"\") {\n        self.loader = true;\n        self.courier.findOrder(data.text).subscribe((res) => {\n          if (res.success == 'true') {\n            self.courier.sumbitOrder(res.order_id).subscribe((re_s) => {\n              if (re_s) {\n                self.submitOrder();\n              }\n              self.loader = false;\n            });\n          } else {\n            self.auth.showError(2);\n            self.loader = false;\n          }\n          self.state$.confirmed = true;\n          self.orders.forEach(order => {\n            if (order.confirm == '0') {\n              self.state$.confirmed = false;\n            }\n          });\n        })\n      } else {\n        self.loader = false;\n      }\n    });\n  }\n\n  public ordersListChanged(orders) {\n    this.orders = orders;\n    let way: any[] = new Array();\n    orders.forEach(order => {\n      if (Number(order.status_id) == 1) {\n        way.push(order.id);\n      }\n    });\n    this.state$.old_way = way;\n  }\n\n  ngOnDestroy() {\n    this.local_stop$.next();\n    this.state$.orders_page_check = false;\n  }\n\n  public manualRoute() {\n    if (this.state$.manual_route) {\n      this.courier.changeRouteMode('auto');\n    } else {\n      this.courier.changeRouteMode('fullHand');\n    }\n    this.vbr.vibrate(300);\n  }\n\n\n  public initContent() {\n    var self = this;\n    this.state$.orders.subscribe(() => {\n\n\n      this.orders = this.state$.orders_data;\n      console.log('sys::initСontent orders', this.orders);\n      this.statuses = [{ \"id\": 4, \"status\": \"Не доставлено\" }, { \"id\": 5, \"status\": \"Доставлено\" }, { \"id\": 6, \"status\": \"Частично доставлено\" }];\n\n      this.ordersInit = true;\n      self.count_orders();\n    })\n  }\n\n\n  public getStatus(order) {\n    return this.courier.getStatus(order);\n  }\n\n  public selectOrder(id) {\n    this.router.navigate(['/order', id]);\n  }\n\n  public tabSelect(tab) {\n    this.selectedTab = tab;\n  }\n\n  customTrackBy(index: number, obj: any): any {\n    return index;\n  }\n\n  public getCondition(status) {\n    switch (this.selectedTab) {\n      case 1:\n        if (status == 1) return true;\n        break;\n      case 2:\n        if (status == 5 || status == 6) return true;\n        break;\n      case 3:\n        if (status == 4) return true;\n        break;\n    }\n    return false;\n  }\n\n  public count_orders(orders = this.courier.ordersInfo) {\n    let g_done = 0;\n    let g_process = 0;\n    let g_fail = 0;\n\n    for (let i = 0; i < orders.length; i++) {\n      switch (String(orders[i].status_id)) {\n        case '4':\n          g_fail++;\n          break;\n        case '5':\n          g_done++;\n          break;\n        case '6':\n          g_done++;\n          break;\n        case '1':\n          g_process++;\n          break;\n      }\n    }\n    this.g_done = g_done;\n    this.g_process = g_process;\n    this.g_fail = g_fail;\n  }\n\n  public startRoute(start = true, stop = false) {\n    let self = this;\n    this.auth.checkAuth().subscribe((data) => {\n      if (data.success == 'true') {\n        self.sendStartRoute(data.sync_id, start, stop);\n      }\n    })\n  }\n\n  public stopRoute() {\n    this.startRoute(false, true);\n  }\n\n\n  public sendStartRoute(cid, start, stop) {\n    const url = \"geo/route_start.php\";\n    let data = {\n      'cid': cid,\n      'lt': this.state$.position.getValue().lt,\n      'lg': this.state$.position.getValue().lg\n    };\n    if (start) {\n      data['start'] = '1';\n    }\n    if (stop) {\n      data['stop'] = '1';\n    }\n    let self = this;\n    this.auth.sendPost(url, data).subscribe((data) => {\n      if (data.success == true) {\n        self.btn_go = true;\n        if (data.result == 'stop') {\n          self.btn_go = false;\n        }\n      }\n    });\n  }\n\n  public scanSearch() {\n    let self = this;\n    this.scanView = !this.scanView;\n    this.loader = true;\n    if (this.auth.getScanMode() == 'scan') {\n      self.courier.findOrder(this.scanInput).subscribe((res) => {\n        self.scanInput = null;\n        if (res.success == 'true') {\n          self.selectOrder(res.order_id);\n        } else {\n          self.auth.showError(2);\n        }\n        self.loader = false;\n        self.scanView = false;\n      })\n    } else {\n      self.loader = false;\n    }\n    this.scan_process = false;\n    this.find_order = false;\n  }\n\n  public findOrder() {\n    let self = this;\n    if (this.auth.getScanMode() == 'scan') {\n      this.scanView = !this.scanView;\n      this.find_order = true;\n      setTimeout(function () {\n        self.sInput.nativeElement.focus();\n      }, 500);\n      return false\n    }\n\n    this.bs.scan().then((data) => {\n      self.courier.findOrder(data.text).subscribe((res) => {\n        if (res.success == 'true') {\n          self.selectOrder(res.order_id);\n        } else {\n          self.auth.showError(2);\n        }\n      })\n    });\n  }\n\n  //Завершение рабочего дня курьера\n  public endWork() {\n    this.courier.endWork().subscribe((data: { success: boolean }) => {\n      if (data.success) {\n        this.isWorkEnded = true;\n        this.sys.presentToast('Рабочий день завершен',\n          'success')\n      }\n    },\n      error => {\n        this.sys.presentToast('Ошибка: ' + error.message, 'danger')\n      })\n\n  }\n  doRefresh(event) {\n    this.data.getApiData().add(event.target.complete());\n\n  }\n\n  public segmentChanged(event) {\n    let ids = [Number(event.target.value)];\n    if (event.target.value == '4') {\n      ids.push(5)\n    }\n    this.prepareOrdersList(ids)\n  }\n\n  public onSearchChange(event) {\n\n\n  }\n  public prepareOrdersList(ids = [1]) {\n\n    this.orders_c = this.ord.pipe(\n      map(\n        orders => orders && orders.filter(order => ids.includes(Number(order.status_id)))\n          .filter(\n            order => order.client_address.toLowerCase().includes(this.searchString.toLowerCase()) || order.client_fio.toLowerCase().includes(this.searchString.toLowerCase()) ||\n              order.client_id.toLowerCase().includes(this.searchString.toLowerCase())\n          )\n          .slice(this.slicer)\n      ),\n      map(\n        (orders) => { orders.forEach((order) => { order.show = false }); this.orders = orders; return orders }\n      )\n    );\n\n  }\n  public howSlice(): number {\n    return (this.settings.rules.typeRoute === 'standart' ? 0 : 1)\n  }\n\n  async popoverHelp(ev: any) {\n    const popover = await this.popoverController.create({\n      component: HelpComponent,\n      event: ev,\n      translucent: true,\n      cssClass: 'help'\n    });\n    return popover\n  }\n\n  async showHelp(ev) {\n    let popover = await this.popoverHelp(ev);\n    popover.present();\n\n  }\n\n  public showRoute(order) {\n    this.map.showRoute(order)\n  }\n\n  public drop(event: CdkDragDrop<any[]>) {\n\n    moveItemInArray(this.orders, event.previousIndex, event.currentIndex);\n    this.data.orders.next(this.orders);\n    console.log('sys:: массив заказов после перетаскивания: ', this.orders);\n  }\n\n  async popoverNote(ev: any) {\n    const popover = await this.popoverController.create({\n      component: HelpComponent,\n      event: ev,\n      translucent: true,\n      cssClass: 'help'\n    });\n    return popover\n  }\n\n  async note(ev) {\n    let popover = await this.popoverNote(ev);\n    popover.present();\n\n  }\n\n}\n"]}