{"version":3,"sources":["webpack:///src/app/pages/courier/courier.module.ts","webpack:///src/app/pages/courier/courier.page.html","webpack:///src/app/pages/courier/courier.page.ts"],"names":["routes","path","component","CourierPageModule","provide","useFactory","forChild","imports","declarations","providers","$event","stopPropagation","auth","CourierPage","courier","router","state$","bs","vbr","settings","sys","data","popoverController","map","orderService","CL","network","orders","statuses","selectedTab","ordersInit","loader","local_stop$","localcheck","g_done","g_process","g_fail","lvl_ind","width","btn_go","notification","subBtnCond","scanView","scan_process","find_order","isWorkEnded","searchString","slicer","howSlice","callWindow","noDrag","segment","self","initContent","position","getValue","startRoute","state","pipe","subscribe","a","initConditions","ord","asObservable","prepareOrdersList","app_mode","getMode","confirmed","Drop_L","autoScrollDisabled","DragItems","changes","r","forEach","DragItem","dragStartDelay","touch","mouse","checkout","rules","storeCheckMode","checkState","localStorage","check","appMode","manual_route","toLowerCase","includes","count_orders","getScanMode","findOrder","scanInput","res","success","sumbitOrder","order_id","re_s","console","log","submitOrder","showError","order","confirm","setTimeout","scanSearch","scanInputStart","sInput","nativeElement","focus","scan","then","text","way","Array","Number","status_id","push","id","old_way","next","orders_page_check","changeRouteMode","vibrate","orders_data","getStatus","navigate","tab","index","obj","status","ordersInfo","i","length","String","start","stop","checkAuth","sendStartRoute","sync_id","cid","url","lt","lg","sendPost","result","selectOrder","endWork","presentToast","error","message","getApiData","event","ids","target","value","orders_c","filter","client_address","client_fio","client_id","slice","show","typeRoute","ev","create","translucent","cssClass","popover","popoverHelp","present","showRoute","previousIndex","currentIndex","rewriteOrders","orderId","componentProps","popoverNote","action","orderPhones","parsePhone","client_phone","courierPhone","courier_phone","selectedPhone","callNumber","undefined","type","phoneClick","client_number","cur_number","resp","phone","phones","replace","normalizePhoneNumber","doRefresh","showHelp","segmentChanged","height","selector","templateUrl","styleUrls","animations"],"mappings":"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","file":"pages-courier-courier-module-es5.js","sourcesContent":["import { DragDropModule } from '@angular/cdk/drag-drop';\nimport { ScrollingModule } from '@angular/cdk/scrolling';\nimport { CommonModule, registerLocaleData } from '@angular/common';\nimport localeRu from '@angular/common/locales/ru';\nimport { LOCALE_ID, NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule, Routes } from '@angular/router';\nimport { IonicModule } from '@ionic/angular';\nimport { IconsModule } from '../../icons/icons.module';\nimport { CourierPage } from './courier.page';\n\nregisterLocaleData(localeRu, 'ru');\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CourierPage\n  }\n];\n\n@NgModule({\n  imports: [\n    IconsModule,\n    CommonModule,\n    FormsModule,\n    DragDropModule,\n    IonicModule,\n    ScrollingModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [CourierPage],\n  providers: [\n    { provide: LOCALE_ID, useFactory: () => 'ru' }\n  ]\n})\nexport class CourierPageModule { }\n","<ion-header>\n  <ion-toolbar class='toolbar'>\n    <ion-buttons slot=\"start\">\n      <ion-button (click)=\"findOrder()\">\n        <i-feather name=\"search\" slot='start'></i-feather>\n      </ion-button>\n      <ion-button *ngIf=\"auth.getGuessMode()\">\n        <i>G</i>\n      </ion-button>\n    </ion-buttons>\n    <ion-title>Мои заказы</ion-title>\n    <ion-title size=\"small\" color=\"dark\">{{state$.filial}}</ion-title>\n    <ion-buttons slot=\"primary\">\n      <ion-button (click)=\"doRefresh()\">\n        <ion-icon slot=\"icon-only\" name=\"refresh-circle-sharp\"></ion-icon>\n      </ion-button>\n      <ion-button *ngIf=\"subBtnCond\" (click)=\"submitOrder()\">\n        <i-feather name=\"box\"></i-feather>\n      </ion-button>\n      <ion-button *ngIf=\"courier.sortOrders?.g_process == 0 && !isWorkEnded\" (click)=\"endWork()\">\n        <i-feather name=\"check-square\"></i-feather>\n      </ion-button>\n      <ion-button (click)=\"showHelp($event)\">\n        <ion-icon slot=\"icon-only\" name=\"help-circle-outline\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content>\n\n  <div class=\"c-wrp\" [ngClass]=\"{  'm_wrp' : auth.getMode() == 'fullHand' || auth.getMode() == 'hand'}\">\n    <ion-segment (ionChange)=\"segmentChanged($event)\" value='1'>\n      <ion-segment-button value=\"1\">\n        <ion-label>В работе</ion-label>\n      </ion-segment-button>\n      <ion-segment-button value=\"5\">\n        <ion-label>Доставлено</ion-label>\n      </ion-segment-button>\n      <ion-segment-button value=\"4\">\n        <ion-label>Не доставлено</ion-label>\n      </ion-segment-button>\n    </ion-segment>\n    <div class=\"c-body\" *ngIf=\"ordersInit && !auth.getGuessMode()\">\n      <ion-searchbar placeholder=\"Поиск по заказам\" inputmode=\"text\" (ionChange)=\"onSearchChange($event)\"\n        [debounce]=\"250\" [(ngModel)]=\"searchString\" animated></ion-searchbar>\n\n      <cdk-virtual-scroll-viewport cdkDropList (cdkDropListDropped)=\"drop($event)\" itemSize=\"50\"\n        style=\"height: 100%; width: 100%; min-height: 50vh;\">\n        <ion-item *ngFor=\"let order of orders_c | async\" [ngClass]=\"{\n         overdue: (order.overdue == '1' || order.required == true) && order.status_id == 1\n        }\" (click)=\"selectOrder(order.id)\" appLongPress (longPress)=\"vibr()\" (hold)=\"vibr()\" (cdkDragStarted)=\"vibr()\"\n          cdkDrag [cdkDragStartDelay]=\"500\" [cdkDragDisabled]='noDrag'>\n          <ion-label [@openClose]=\"order.show ? 'open' : 'closed'\">\n            <div class='title'>\n              <span>\n                <span class='client-id'> {{order.client_id}}</span>\n                <span> ({{order.company}})</span>\n              </span>\n              <span class='client-id'>\n                <span *ngIf=\"order.datetime_from\">c {{ order.datetime_from | date: 'H:mm':'ru' }} </span>\n                <span *ngIf=\"order.datetime_to\">до {{ order.datetime_to | date: 'H:mm':'ru' }}</span>\n              </span>\n            </div>\n            <div class='name'>{{order.client_fio}}</div>\n            <div class='addr'>{{order.client_address}}</div>\n\n            <div class=\"actions\" *ngIf='order.show'>\n              <ion-button fill=\"solid\" size='default' (click)=\"note($event, order.id); $event.stopPropagation()\"\n                id='light-blue-button'>\n                <ion-icon slot=\"start\" name='document'></ion-icon>\n                Заметки\n              </ion-button>\n              <ion-button fill=\"solid\" size='default' (click)=\"showRoute(order); $event.stopPropagation()\"\n                id=\"light-purple-button\">\n                <ion-icon slot=\"start\" name=\"location-outline\"></ion-icon>\n                Маршрут\n              </ion-button>\n              <ion-button fill=\"solid\" size='default' (click)=\"phoneClick('init', order); $event.stopPropagation()\"\n                id='light-green-button'>\n                <ion-icon slot=\"start\" name=\"call-outline\"></ion-icon>\n                Позвонить\n              </ion-button>\n            </div>\n          </ion-label>\n          <ion-icon name=\"ellipsis-vertical\" slot='start' class='points'></ion-icon>\n\n          <div class=\"actions-button\" (click)=\"order.show = !order.show; $event.stopPropagation()\">\n            <ion-icon src='../../../assets/actions-arrows.svg' [ngClass]=\"{turned: order.show == true }\"></ion-icon>\n          </div>\n        </ion-item>\n      </cdk-virtual-scroll-viewport>\n    </div>\n    <div class='ion-padding sub-footer'>\n      <div class=\"orders-lable ion-justify-content-between \">\n        <div class='ion-margin-vertical'>\n          <span>Всего:</span> {{courier.sortOrders.all}}\n        </div>\n        <div *ngIf=\"courier.sortOrders.g_process != 0\" class='ion-margin'>\n          <span>В работе:</span> {{courier.sortOrders?.g_process}}\n        </div>\n        <div *ngIf=\"courier.sortOrders.g_fail != 0\" class='ion-margin'>\n          <span>Не доставлено:</span> <span style=\"color: red\">{{courier.sortOrders.g_fail}}</span>\n        </div>\n        <div *ngIf=\"courier.sortOrders.g_done != 0\" class='ion-margin'>\n          <span>Доставлено:</span> {{courier.sortOrders.g_done}}\n        </div>\n      </div>\n\n      <div class=\"checking\" *ngIf=\"auth.checkState !== 'checkedOut'\">\n        <ion-button (click)=\"auth.check('In')\" expand=\"full\" fill=\"solid\" *ngIf=\"auth.checkState == 'checkedundefined'\">\n          Приехал на склад\n        </ion-button>\n        <ion-button (click)=\"auth.check('Out')\" expand=\"full\" fill=\"solid\" *ngIf=\"auth.checkState == 'checkedIn'\">\n          Уехал со склада\n        </ion-button>\n      </div>\n    </div>\n    <div class=\"start-route\"\n      *ngIf=\"ordersInit && state$.orders_data != [] && state$.orders_data !== null && auth.checkState == 'checkedOut'\">\n      <button class=\"satrt-r-btn\" *ngIf=\"!btn_go && !this.state$.manual_route && auth.routingModeAuto\"\n        (click)=\"startRoute()\">\n        Начать маршрут\n      </button>\n      <button class=\"satrt-r-btn sr-stop\" *ngIf=\"btn_go && !this.state$.manual_route\" (click)=\"stopRoute()\">\n        Остановить маршрут\n      </button>\n      <button class=\"satrt-r-btn find-o-btn\" *ngIf=\"auth.getMode() == 'auto' || auth.getMode() == 'auto_wo'\"\n        [ngClass]=\"{  'manual_btn' : this.state$.manual_route}\" (click)=\"manualRoute()\">\n        <span *ngIf=\"this.state$.manual_route\">Автоматический режим</span>\n        <span *ngIf=\"!this.state$.manual_route\">Ручной режим</span>\n      </button>\n    </div>\n    <div class=\"scanWindow\" *ngIf=\"scanView\">\n      <div class=\"sw-wrp\">\n        <div class=\"sw-title\">Просканируйте штрихкод</div>\n        <input #sInput class=\"ionInp\" (change)=\"scanInputChange()\" [(ngModel)]=\"scanInput\" autofocus />\n      </div>\n    </div>\n  </div>\n\n  <div class=\"shirm\" *ngIf=\"loader\">\n    <ion-spinner name=\"lines-small\"></ion-spinner>\n  </div>\n  <div class=\"call-window\" *ngIf=\"callWindow\">\n    <div class=\"cw-body\">\n      <i-feather name=\"x-square\" (click)=\"callWindow = !callWindow\" size=\"large\"></i-feather>\n      <ion-list *ngIf=\"orderPhones.length > 1\">\n        <ion-radio-group name=\"selectedPhone\" [(ngModel)]=\"selectedPhone\">\n          <ion-list-header>\n            <ion-label>Выберите номер</ion-label>\n          </ion-list-header>\n          <ion-item *ngFor=\"let phone of orderPhones\">\n            <ion-radio value=\"{{phone}}\"></ion-radio>\n            <ion-label>{{phone}}</ion-label>\n          </ion-item>\n        </ion-radio-group>\n      </ion-list>\n      <button (click)=\"phoneClick('phone', order)\"\n        *ngIf=\"settings.rules.phoneMode == 'robotPhone' || settings.rules.phoneMode == 'phone' \">\n        Позвонить со своего телефона\n      </button>\n      <button (click)=\"phoneClick('operator',order)\"\n        *ngIf=\"settings.rules.phoneMode == 'robotPhone' || settings.rules.phoneMode == 'robot' \">\n        Позвонить через ip-шлюз\n      </button>\n    </div>\n  </div>\n</ion-content>","import {\n  animate,\n  state,\n  style,\n  transition,\n  trigger\n} from '@angular/animations';\nimport { CdkDrag, CdkDragDrop, CdkDropList, moveItemInArray } from '@angular/cdk/drag-drop';\nimport { Component, ElementRef, OnInit, QueryList, ViewChild, ViewChildren } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { BarcodeScanner } from '@ionic-native/barcode-scanner/ngx';\nimport { CallNumber } from '@ionic-native/call-number/ngx';\nimport { Network } from '@ionic-native/network/ngx';\nimport { Vibration } from '@ionic-native/vibration/ngx';\nimport { PopoverController } from \"@ionic/angular\";\nimport { Observable, Subject } from 'rxjs';\nimport { map, takeUntil } from 'rxjs/operators';\nimport { Order } from 'src/app/interfaces/order';\nimport { MapService } from 'src/app/services/sys/map.service';\nimport { OrderService } from 'src/app/services/sys/order.service';\nimport { HelpComponent } from '../../components/help/help.component';\nimport { NoteComponent } from '../../components/note/note.component';\nimport { AuthService } from '../../services/auth.service';\nimport { CourierService } from '../../services/courier.service';\nimport { SettingsService } from '../../services/settings.service';\nimport { StateService } from '../../services/state.service';\nimport { SysService } from '../../services/sys.service';\nimport { DataService } from '../../services/sys/data.service';\n\n\n@Component({\n  selector: 'app-courier',\n  templateUrl: './courier.page.html',\n  styleUrls: ['./courier.page.scss'],\n  animations: [\n    trigger('openClose', [\n      // ...\n      state('open', style({\n        height: 'auto',\n      })),\n      state('closed', style({\n        height: 'max-content',\n      })),\n      transition('open => closed', [\n        animate('0.5s')\n      ]),\n      transition('closed => open', [\n        animate('0.5s')\n      ]),\n    ])\n  ]\n})\nexport class CourierPage implements OnInit {\n  @ViewChild('sInput') public sInput: ElementRef;\n  @ViewChild(CdkDropList, { static: false })\n  Drop_L: CdkDropList;\n  @ViewChildren(CdkDrag)\n  DragItems: QueryList<CdkDrag>;\n\n  public orders: any = null;\n  public statuses: any = null;\n  public selectedTab = 1;\n  public ordersInit: boolean = false;\n  public loader: boolean = false;\n  public local_stop$: Subject<any> = new Subject();\n  public localcheck: boolean = false;\n  public g_done = 0;\n  public g_process = 0;\n  public g_fail = 0;\n  public lvl_ind = { width: '0%' };\n  public btn_go: boolean = false;\n  public notification = null;\n  public subBtnCond: boolean = true;\n  public scanView: boolean = false;\n  public scanInput;\n  public scan_process = false;\n  public find_order: boolean = false;\n  public isWorkEnded: boolean = false;\n  public searchString = '';\n  private ord: Observable<any[]>;\n  public orders_c: Observable<any>;\n  public slicer: number = this.howSlice();\n  public callWindow: boolean = false;\n  public selectedPhone: string;\n  public orderPhones: string[];\n  public order: Order;\n  public noDrag = false;\n  private segment: number[] = [1];\n\n  constructor(public courier: CourierService,\n    private router: Router,\n    public state$: StateService,\n    public auth: AuthService,\n    private bs: BarcodeScanner,\n    public vbr: Vibration,\n    public settings: SettingsService,\n    private sys: SysService,\n    private data: DataService,\n    public popoverController: PopoverController,\n    private map: MapService,\n    private orderService: OrderService,\n    private CL: CallNumber,\n    private network: Network\n\n  ) {\n    let self = this;\n\n    this.initContent();\n    if (this.state$.position.getValue() != null) {\n      this.startRoute(false);\n    }\n\n\n    this.state$.state.pipe(takeUntil(this.local_stop$)).subscribe((state) => {\n      const a = state;\n      if (state == 'orders_init') {\n        self.initContent();\n      }\n    })\n    this.initConditions();\n    this.ord = this.data.orders.asObservable();\n    this.prepareOrdersList();\n\n  }\n\n  public initConditions() {\n    let app_mode = this.auth.getMode();\n    switch (app_mode) {\n      case 'fullAuto':\n        if (!this.state$.confirmed) this.subBtnCond = true;;\n        break;\n      case 'auto':\n        this.subBtnCond = false;\n        break;\n      case 'fullHand':\n        if (!this.state$.confirmed) this.subBtnCond = true;\n        break;\n      case 'hand':\n        this.subBtnCond = false;\n        break;\n    }\n  }\n\n  ngAfterViewChecked() {\n    this.Drop_L.autoScrollDisabled = false;\n    this.DragItems.changes.subscribe((r) => {\n      this.DragItems.forEach(DragItem => {\n        DragItem.dragStartDelay = {\n          touch: 500,\n          mouse: 100\n        };\n      })\n    });\n  }\n\n  ngOnInit() {\n    this.settings.checkout = !!(this.settings.rules.storeCheckMode - 0);\n    if (!this.settings.checkout) {\n      this.auth.checkState = 'checkedOut'\n    } else {\n      this.auth.checkState = 'checked' + localStorage.check\n    }\n    if (this.settings.rules.appMode == 'hand') {\n      this.state$.manual_route = true\n    }\n    if (this.settings.rules.appMode.toLowerCase().includes('auto')) {\n      this.noDrag = true;\n    }\n    this.data.orders.subscribe((orders) => {\n      this.courier.count_orders(orders)\n    })\n  }\n\n  public scanInputStart() {\n    let self = this;\n    this.scanView = !this.scanView;\n    this.loader = true;\n    if (this.auth.getScanMode() == 'scan') {\n      self.courier.findOrder(this.scanInput).subscribe((res) => {\n        self.scanInput = null;\n        if (res.success == 'true') {\n          self.courier.sumbitOrder(res.order_id).subscribe((re_s) => {\n            console.log('courier_page sbo resp', re_s);\n            if (re_s) {\n              self.submitOrder();\n            } else {\n              self.scanView = false;\n            }\n            self.loader = false;\n          });\n        } else {\n          self.auth.showError(2);\n          self.loader = false;\n          self.scanView = false;\n        }\n        self.state$.confirmed = true;\n        self.orders.forEach(order => {\n          if (order.confirm == '0') {\n            self.state$.confirmed = false;\n          }\n        });\n      })\n    } else {\n      self.loader = false;\n    }\n    this.scan_process = false;\n  }\n\n  public scanInputChange() {\n    console.log('inputData', this.scanInput);\n    let self = this;\n    if (this.scan_process) return false;\n    this.scan_process = true;\n    if (this.find_order) {\n      setTimeout(function () {\n        self.scanSearch();\n      }, 1500)\n    } else {\n      setTimeout(function () {\n        self.scanInputStart();\n      }, 1500)\n    }\n  }\n\n  public submitOrder() {\n    var self = this;\n    console.log('SUBMIT_ORDER_CALL');\n    if (this.auth.getScanMode() == 'scan') {\n      this.scanView = !this.scanView;\n      setTimeout(function () {\n        self.sInput.nativeElement.focus();\n      }, 500);\n      return false\n    }\n    this.bs.scan().then((data) => {\n      console.log('SCAN_RETURN_DATA', data);\n      if (data.text != \"\") {\n        self.loader = true;\n        self.courier.findOrder(data.text).subscribe((res) => {\n          if (res.success == 'true') {\n            self.courier.sumbitOrder(res.order_id).subscribe((re_s) => {\n              if (re_s) {\n                self.submitOrder();\n              }\n              self.loader = false;\n            });\n          } else {\n            self.auth.showError(2);\n            self.loader = false;\n          }\n          self.state$.confirmed = true;\n          self.orders.forEach(order => {\n            if (order.confirm == '0') {\n              self.state$.confirmed = false;\n            }\n          });\n        })\n      } else {\n        self.loader = false;\n      }\n    });\n  }\n\n  public ordersListChanged(orders) {\n    this.orders = orders;\n    let way: any[] = new Array();\n    orders.forEach(order => {\n      if (Number(order.status_id) == 1) {\n        way.push(order.id);\n      }\n    });\n    this.state$.old_way = way;\n  }\n\n  ngOnDestroy() {\n    this.local_stop$.next();\n    this.state$.orders_page_check = false;\n  }\n\n  public manualRoute() {\n    if (this.state$.manual_route) {\n      this.courier.changeRouteMode('auto');\n    } else {\n      this.courier.changeRouteMode('fullHand');\n    }\n    this.vbr.vibrate(300);\n  }\n\n\n  public initContent() {\n    var self = this;\n    this.state$.orders.subscribe(() => {\n      this.orders = this.state$.orders_data;\n      console.log('sys::initСontent orders', this.orders);\n      this.statuses = [{ \"id\": 4, \"status\": \"Не доставлено\" }, { \"id\": 5, \"status\": \"Доставлено\" }, { \"id\": 6, \"status\": \"Частично доставлено\" }];\n      this.ordersInit = true;\n      self.count_orders();\n    })\n  }\n\n\n  public getStatus(order) {\n    return this.courier.getStatus(order);\n  }\n\n  public selectOrder(id) {\n\n    this.router.navigate(['/order', id]);\n  }\n\n  public tabSelect(tab) {\n    this.selectedTab = tab;\n  }\n\n  customTrackBy(index: number, obj: any): any {\n    return index;\n  }\n\n  public getCondition(status) {\n    switch (this.selectedTab) {\n      case 1:\n        if (status == 1) return true;\n        break;\n      case 2:\n        if (status == 5 || status == 6) return true;\n        break;\n      case 3:\n        if (status == 4) return true;\n        break;\n    }\n    return false;\n  }\n\n  public count_orders(orders = this.courier.ordersInfo) {\n    let g_done = 0;\n    let g_process = 0;\n    let g_fail = 0;\n\n    for (let i = 0; i < orders.length; i++) {\n      switch (String(orders[i].status_id)) {\n        case '4':\n          g_fail++;\n          break;\n        case '5':\n          g_done++;\n          break;\n        case '6':\n          g_done++;\n          break;\n        case '1':\n          g_process++;\n          break;\n      }\n    }\n    this.g_done = g_done;\n    this.g_process = g_process;\n    this.g_fail = g_fail;\n  }\n\n  public startRoute(start = true, stop = false) {\n    let self = this;\n    this.auth.checkAuth().subscribe((data) => {\n      if (data.success == 'true') {\n        self.sendStartRoute(data.sync_id, start, stop);\n      }\n    })\n  }\n\n  public stopRoute() {\n    this.startRoute(false, true);\n  }\n\n\n  public sendStartRoute(cid, start, stop) {\n    const url = \"geo/route_start.php\";\n    let data = {\n      'cid': cid,\n      'lt': this.state$.position.getValue().lt,\n      'lg': this.state$.position.getValue().lg\n    };\n    if (start) {\n      data['start'] = '1';\n    }\n    if (stop) {\n      data['stop'] = '1';\n    }\n    let self = this;\n    this.auth.sendPost(url, data).subscribe((data) => {\n      if (data.success == true) {\n        self.btn_go = true;\n        if (data.result == 'stop') {\n          self.btn_go = false;\n        }\n      }\n    });\n  }\n\n  public scanSearch() {\n    let self = this;\n    this.scanView = !this.scanView;\n    this.loader = true;\n    if (this.auth.getScanMode() == 'scan') {\n      self.courier.findOrder(this.scanInput).subscribe((res) => {\n        self.scanInput = null;\n        if (res.success == 'true') {\n          self.selectOrder(res.order_id);\n        } else {\n          self.auth.showError(2);\n        }\n        self.loader = false;\n        self.scanView = false;\n      })\n    } else {\n      self.loader = false;\n    }\n    this.scan_process = false;\n    this.find_order = false;\n  }\n\n  public findOrder() {\n    let self = this;\n    if (this.auth.getScanMode() == 'scan') {\n      this.scanView = !this.scanView;\n      this.find_order = true;\n      setTimeout(function () {\n        self.sInput.nativeElement.focus();\n      }, 500);\n      return false\n    }\n\n    this.bs.scan().then((data) => {\n      self.courier.findOrder(data.text).subscribe((res) => {\n        if (res.success == 'true') {\n          self.selectOrder(res.order_id);\n        } else {\n          self.auth.showError(2);\n        }\n      })\n    });\n  }\n\n  //Завершение рабочего дня курьера\n  public endWork() {\n    this.courier.endWork().subscribe((data: { success: boolean }) => {\n      if (data.success) {\n        this.isWorkEnded = true;\n        this.sys.presentToast('Рабочий день завершен',\n          'success')\n      }\n    },\n      error => {\n        this.sys.presentToast('Ошибка: ' + error.message, 'danger')\n      })\n\n  }\n  doRefresh() {\n    this.data.getApiData();\n\n  }\n\n  public segmentChanged(event) {\n    let ids = [Number(event.target.value)];\n    if (event.target.value == '5') {\n      ids.push(6)\n    }\n    this.segment = ids;\n    this.prepareOrdersList(ids)\n  }\n\n  public onSearchChange(event) {\n    this.searchString = event.target.value;\n    this.prepareOrdersList(this.segment)\n\n  }\n  public prepareOrdersList(ids = this.segment) {\n\n    this.orders_c = this.ord.pipe(\n      map(\n        orders => orders && orders.filter(order => ids.includes(Number(order.status_id)))\n          .filter(\n            order => order.client_address.toLowerCase().includes(this.searchString.toLowerCase()) || order.client_fio.toLowerCase().includes(this.searchString.toLowerCase()) ||\n              order.client_id.toLowerCase().includes(this.searchString.toLowerCase())\n          )\n          .slice(this.slicer)\n      ),\n      map(\n        (orders) => { orders.forEach((order) => { order.show = false }); this.orders = orders; return orders }\n      )\n    );\n\n  }\n  public howSlice(): number {\n    return (this.settings.rules.typeRoute === 'standart' ? 0 : 1)\n  }\n\n  async popoverHelp(ev: any) {\n    const popover = await this.popoverController.create({\n      component: HelpComponent,\n      event: ev,\n      translucent: true,\n      cssClass: 'help'\n    });\n    return popover\n  }\n\n  async showHelp(ev) {\n    let popover = await this.popoverHelp(ev);\n    popover.present();\n\n  }\n\n  public showRoute(order) {\n    this.map.showRoute(order)\n  }\n\n  public drop(event: CdkDragDrop<any[]>) {\n\n    moveItemInArray(this.orders, event.previousIndex, event.currentIndex);\n    this.data.rewriteOrders(this.orders);\n    console.log('sys:: массив заказов после перетаскивания: ', this.orders);\n  }\n\n  async popoverNote(ev: any, orderId: string) {\n    const popover = await this.popoverController.create({\n      component: NoteComponent,\n      event: ev,\n      translucent: true,\n      cssClass: 'help',\n      componentProps: {\n        \"orderId\": orderId\n      }\n    });\n    return popover\n  }\n\n  public async note(ev, orderId: string) {\n    let popover = await this.popoverNote(ev, orderId);\n    popover.present();\n  }\n\n  //Звонок получателю заказа\n  public phoneClick(action: string, order: Order) {\n    this.order = order;\n    this.orderPhones = this.parsePhone(order.client_phone);\n    let courierPhone = this.parsePhone(order.courier_phone)[0];\n    if (this.orderPhones.length == 1) {\n      this.selectedPhone = this.orderPhones[0];\n    }\n\n    switch (action) {\n      case \"init\":\n        this.callWindow = !this.callWindow;\n        break;\n      case \"phone\":\n        this.CL.callNumber(this.selectedPhone, false).then(() => { });\n        this.callWindow = false;\n        this.order = undefined;\n        break;\n      case \"operator\":\n        if (this.network.type == 'none') {\n          this.phoneClick('phone', order);\n          return false;\n        }\n        if (this.selectedPhone && courierPhone) {\n          let url = \"orders\";\n          let data = {\n            action: \"send_phone\",\n            client_number: this.selectedPhone,\n            cur_number: courierPhone,\n          };\n          this.auth.sendPost(url, data).subscribe((resp) => {\n            console.log(\"call_subs\", resp);\n          });\n          this.auth.showError(9);\n          this.callWindow = false;\n        }\n        this.order = undefined;\n        break;\n    }\n  }\n\n  //Парсинг номера телефона из строки с лишним мусором\n  public parsePhone(phone): Array<string> {\n    let phones: Array<string> = [];\n    phone = phone.replace(/\\D+/g, \"\");\n\n    while (phone.length > 7) {\n      phone = this.normalizePhoneNumber(phone);\n      phones.push(phone.slice(\"\", 11));\n      phone = phone.slice(11);\n    }\n    return phones;\n  }\n\n  //Жонглирование '8' / '+7'\n  private normalizePhoneNumber(phone): string {\n    if (phone[0] !== \"8\" && phone[0] !== \"7\" && phone.length !== 11) {\n      phone = \"8\" + phone;\n    }\n    if (phone.length == 7 || phone.length == 10) {\n      phone = \"8\" + phone;\n    }\n    if (phone[0] !== \"8\" && phone.length == 11) {\n      phone = \"8\" + phone.slice(1);\n    }\n    return phone;\n  }\n\n\n  public vibr($event?) {\n    this.vbr.vibrate(10);\n    console.log('sys:: *Вибирация*');\n  }\n\n}\n"]}