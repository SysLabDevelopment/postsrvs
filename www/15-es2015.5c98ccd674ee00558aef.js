(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{F4UR:function(t,e,n){"use strict";n.r(e),n.d(e,"LoginPageModule",(function(){return K}));var o=n("SVse"),i=n("s7LF"),s=n("iInd"),r=n("bOtU"),c=n("sZkV"),b=n("sbs8"),h=n("GS7A"),d=n("IheW"),a=n("4zgz"),p=n("oXA7"),l=n("bk9D"),u=n("D279"),g=n("lGQG"),f=n("24R0"),_=n("6nr9"),y=n("ndxW"),w=n("tudd"),x=n("8Y7J"),O=n("1tbR");function C(t,e){1&t&&(x.Lb(0,"span",15),x.pc(1,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0442\u0435\u043b\u0435\u0444\u043e\u043d"),x.Kb())}function P(t,e){1&t&&(x.Lb(0,"div",16),x.Jb(1,"i-feather",17),x.Kb())}function m(t,e){if(1&t){const t=x.Mb();x.Lb(0,"div",8),x.Lb(1,"div",9),x.pc(2,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u043c\u0435\u0440"),x.Kb(),x.Lb(3,"div",10),x.oc(4,C,2,0,"span",11),x.Lb(5,"input",12),x.Sb("ngModelChange",(function(e){return x.jc(t),x.Ub().phone=e}))("input",(function(){return x.jc(t),x.Ub().changePhone()})),x.Kb(),x.Lb(6,"button",13),x.Sb("click",(function(){return x.jc(t),x.Ub().enterPhone()})),x.pc(7,"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"),x.Kb(),x.Kb(),x.oc(8,P,2,0,"div",14),x.Kb()}if(2&t){const t=x.Ub();x.yb(4),x.bc("ngIf",t.error_phone),x.yb(1),x.bc("showMaskTyped",!0)("ngModel",t.phone),x.yb(3),x.bc("ngIf",t.loader)}}function M(t,e){1&t&&(x.Lb(0,"span",15),x.pc(1,"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043a\u043e\u0434"),x.Kb())}function j(t,e){1&t&&(x.Lb(0,"div",16),x.Jb(1,"i-feather",17),x.Kb())}const I=function(t){return{"btn-resend":t}};function L(t,e){if(1&t){const t=x.Mb();x.Lb(0,"div",18),x.Lb(1,"div",9),x.pc(2,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434"),x.Kb(),x.Lb(3,"div",10),x.oc(4,M,2,0,"span",11),x.Lb(5,"input",19),x.Sb("ngModelChange",(function(e){return x.jc(t),x.Ub().code=e}))("input",(function(){return x.jc(t),x.Ub().changePhone()})),x.Kb(),x.Lb(6,"button",13),x.Sb("click",(function(){return x.jc(t),x.Ub().enterCode()})),x.pc(7,"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"),x.Kb(),x.Lb(8,"button",20),x.Sb("click",(function(){return x.jc(t),x.Ub().reEnterPhone()})),x.pc(9),x.Kb(),x.Kb(),x.oc(10,j,2,0,"div",14),x.Kb()}if(2&t){const t=x.Ub();x.yb(4),x.bc("ngIf",t.error_phone),x.yb(1),x.bc("showMaskTyped",!0)("ngModel",t.code),x.yb(3),x.bc("ngClass",x.ec(6,I,t.resend_dis)),x.yb(1),x.rc(" \u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e ",t.dis_timer," "),x.yb(1),x.bc("ngIf",t.loader)}}const v=function(t){return{"btn-open":t}},k=[{path:"",component:(()=>{class t{constructor(t,e,n,o,i,s,r,c,b,h,d){this.auth=t,this.router=e,this.alert=n,this.plt=o,this.http=i,this.state$=s,this.AP=r,this.courier=c,this.settings=b,this.sys=h,this.sysMap=d,this.pl_window=!1,this.error_phone=!1,this.phone="",this.loader=!1,this.auth_step=!1,this.code=null,this.resend_dis=!1,this.dis_timer=null,this.$stopTimer=new p.a;let a=this;this.plt.ready().then(t=>{console.log("sys:: \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0430 \u0433\u043e\u0442\u043e\u0432\u0430:",t),"android"==t&&this.AP.requestPermission(this.AP.PERMISSION.ACCESS_FINE_LOCATION),this.auth.checkAuth().subscribe(t=>{"true"==t.success&&(this.auth.setUser(t.sync_id),this.settings.getSettings(t.sync_id),a.router.navigate(["map"]),a.auth.initLogin())})})}ngOnInit(){"true"==localStorage.debug&&(this.auth.isDebug=!0)}scanAuth(){let t=this;this.auth.scanData().then(e=>{let n=e.text.slice(0,-4);localStorage.setItem("cId",n),t.auth.login({action:"auth",barcode:e.text}).subscribe(e=>{"true"==e.success?(t.auth.initLogin(),this.auth.setUser(e.sync_id),this.settings.getSettings(e.sync_id),t.router.navigate(["map"])):t.auth.showError(1)})})}phoneAuth(){this.auth_step||(this.pl_window=!this.pl_window)}enterPhone(){this.phone&&this.phone.length>9?(this.loader=!0,this.sendPhone()):this.error_phone=!0}changePhone(){this.error_phone=!1}sendPhone(){var t=this;this.sendPost(this.sys.proxy+"https://mok.flexcore.ru/client/registerP/","action=registerP&phone=8"+this.phone+"&type=courier").subscribe(e=>{"true"==e.success?t.authStep():this.showLoginError(4)},t=>{this.showLoginError(3)}),this.startTimer()}sendPost(t,e){console.log("send_data",e);const n={headers:new d.e({"Access-Control-Allow-Origin":"*","Content-type":"application/x-www-form-urlencoded","Access-Control-Allow-Headers":"*"})};return this.http.post(t,e,n)}authStep(){this.auth_step=!0,this.loader=!1}enterCode(){var t=this;this.sendPost(this.sys.proxy+"https://mok.flexcore.ru/courier/authP/","action=authP&phone=8"+this.phone+"&code="+this.code+"&type=courier").subscribe(e=>{console.log("sendCode",e),"true"==e.success?t.login(e.user):t.error_phone=!0})}login(t){let e="33dbcda2db5311e39760309e88d17f08,"+t;localStorage.setItem("cId",t);var n=this;this.auth.login({action:"auth",barcode:e}).subscribe(t=>{"true"==t.success?(this.auth.setUser(t.sync_id),this.settings.getSettings(t.sync_id),n.router.navigate(["map"]),n.auth.initLogin()):n.auth.showError(1)})}showLoginError(t){switch(t){case 3:case 4:this.loader=!1,this.phone=null,this.pl_window=!1,this.auth.showError(t)}}startTimer(){if(this.resend_dis)return!1;this.resend_dis=!0,this.dis_timer=30;var t=this;this.state$.interval_1ss.pipe(Object(l.a)(this.$stopTimer)).subscribe(()=>{t.dis_timer--,0==t.dis_timer&&(t.dis_timer=null,t.$stopTimer.next(null),t.resend_dis=!1)})}reEnterPhone(){if(this.resend_dis)return!1;this.sendPhone()}changeCode(){}}return t.\u0275fac=function(e){return new(e||t)(x.Ib(g.a),x.Ib(s.g),x.Ib(c.a),x.Ib(c.I),x.Ib(d.b),x.Ib(y.a),x.Ib(a.a),x.Ib(f.a),x.Ib(_.a),x.Ib(w.a),x.Ib(u.a))},t.\u0275cmp=x.Cb({type:t,selectors:[["app-login"]],decls:11,vars:7,consts:[[1,"lg-wrp"],[1,"lg-btn"],[1,"lg-login",3,"click"],[1,"lg-login","login-phone",3,"ngClass"],[1,"btn-wrp"],[1,"btn-title",3,"click"],["class","btn-body phone-b",4,"ngIf"],["class","btn-body code-b",4,"ngIf"],[1,"btn-body","phone-b"],[1,"bi-title"],[1,"bi-inp"],["class","error-phone",4,"ngIf"],["type","tel","prefix","+7 ","mask","(000) 000 00 00",1,"phone-inp",3,"showMaskTyped","ngModel","ngModelChange","input"],[1,"enter-phone",3,"click"],["class","sh-icons",4,"ngIf"],[1,"error-phone"],[1,"sh-icons"],["name","loader"],[1,"btn-body","code-b"],["type","tel","mask","00-00",1,"phone-inp",3,"showMaskTyped","ngModel","ngModelChange","input"],[1,"enter-phone",3,"ngClass","click"]],template:function(t,e){1&t&&(x.Lb(0,"ion-content"),x.Lb(1,"div",0),x.Lb(2,"div",1),x.Lb(3,"button",2),x.Sb("click",(function(){return e.scanAuth()})),x.pc(4," \u0412\u043e\u0439\u0442\u0438 \u043f\u043e QR-\u043a\u043e\u0434\u0443 "),x.Kb(),x.Lb(5,"button",3),x.Lb(6,"div",4),x.Lb(7,"div",5),x.Sb("click",(function(){return e.phoneAuth()})),x.pc(8,"\u0412\u043e\u0439\u0442\u0438 \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430"),x.Kb(),x.oc(9,m,9,4,"div",6),x.oc(10,L,11,8,"div",7),x.Kb(),x.Kb(),x.Kb(),x.Kb(),x.Kb()),2&t&&(x.yb(3),x.bc("@openClose1",e.auth_step?"closed":"open"),x.yb(2),x.bc("ngClass",x.ec(5,v,e.pl_window))("@openClose",e.pl_window?"open":"closed"),x.yb(4),x.bc("ngIf",!e.auth_step),x.yb(1),x.bc("ngIf",e.auth_step))},directives:[c.i,o.j,o.l,r.a,i.a,i.f,i.g,O.a],styles:[".lg-wrp[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;bottom:0}.lg-btn[_ngcontent-%COMP%], .lg-wrp[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.lg-btn[_ngcontent-%COMP%]{min-height:22%;width:80%;flex-direction:column}.lg-login[_ngcontent-%COMP%]{outline:none;height:50px;width:100%;background:no-repeat;box-shadow:0 0 1px 1px #bdbdbd;border-radius:3px;color:#4a4a4a;font-size:19px;margin:5px 0}.login-phone[_ngcontent-%COMP%]{overflow:hidden;padding:0}.btn-title[_ngcontent-%COMP%]{color:#4a4a4a;font-size:19px}.btn-wrp[_ngcontent-%COMP%]{height:100%;display:grid;grid-template-rows:50px auto}.btn-title[_ngcontent-%COMP%]{height:50px;width:100%}.btn-body[_ngcontent-%COMP%], .btn-title[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.btn-body[_ngcontent-%COMP%]{flex-direction:column;position:relative}.error-phone[_ngcontent-%COMP%]{font-size:15px;color:#c50000}.phone-inp[_ngcontent-%COMP%]{margin:6px 0 0;height:45px;border:none;box-shadow:0 0 1px 1px #bdbdbd;border-radius:3px;text-align:center}.btn-open[_ngcontent-%COMP%]   .btn-title[_ngcontent-%COMP%]{border-bottom:1px solid #bdbdbd}.enter-phone[_ngcontent-%COMP%]{margin:8px 0 0;height:45px;border:none;background:none;box-shadow:0 0 1px 1px #bdbdbd;border-radius:3px;text-align:center;font-size:20px;width:100%;color:#2b637e;outline:none}.bi-inp[_ngcontent-%COMP%]{flex-direction:column;padding:12px 0 0}.bi-inp[_ngcontent-%COMP%], .sh-icons[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.sh-icons[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.1);font-size:35px;color:#2b637e}.btn-resend[_ngcontent-%COMP%]{color:#8d999e}"],data:{animation:[Object(h.j)("openClose",[Object(h.g)("open",Object(h.h)({height:"264px"})),Object(h.g)("closed",Object(h.h)({height:"50px"})),Object(h.i)("open => closed",[Object(h.e)("0.5s")]),Object(h.i)("closed => open",[Object(h.e)("0.5s")])]),Object(h.j)("openClose1",[Object(h.g)("open",Object(h.h)({height:"50px"})),Object(h.g)("closed",Object(h.h)({height:"0px",display:"none"})),Object(h.i)("open => closed",[Object(h.e)("0.5s")]),Object(h.i)("closed => open",[Object(h.e)("0.5s")])])]}}),t})()}];let K=(()=>{class t{}return t.\u0275mod=x.Gb({type:t}),t.\u0275inj=x.Fb({factory:function(e){return new(e||t)},imports:[[b.a,o.c,i.b,c.E,r.b.forRoot(),s.i.forChild(k)]]}),t})()}}]);