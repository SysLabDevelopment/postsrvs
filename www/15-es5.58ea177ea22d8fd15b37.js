!function(){function n(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function t(n,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{F4UR:function(e,o,i){"use strict";i.r(o),i.d(o,"LoginPageModule",(function(){return E}));var s=i("SVse"),c=i("s7LF"),r=i("iInd"),b=i("bOtU"),a=i("sZkV"),h=i("sbs8"),u=i("GS7A"),d=i("IheW"),l=i("4zgz"),p=i("XNiG"),g=i("1G5W"),f=i("D279"),y=i("lGQG"),_=i("24R0"),v=i("6nr9"),w=i("ndxW"),x=i("tudd"),O=i("8Y7J"),C=i("1tbR");function P(n,t){1&n&&(O.Lb(0,"span",15),O.pc(1,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0442\u0435\u043b\u0435\u0444\u043e\u043d"),O.Kb())}function m(n,t){1&n&&(O.Lb(0,"div",16),O.Jb(1,"i-feather",17),O.Kb())}function k(n,t){if(1&n){var e=O.Mb();O.Lb(0,"div",8),O.Lb(1,"div",9),O.pc(2,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u043c\u0435\u0440"),O.Kb(),O.Lb(3,"div",10),O.oc(4,P,2,0,"span",11),O.Lb(5,"input",12),O.Sb("ngModelChange",(function(n){return O.jc(e),O.Ub().phone=n}))("input",(function(){return O.jc(e),O.Ub().changePhone()})),O.Kb(),O.Lb(6,"button",13),O.Sb("click",(function(){return O.jc(e),O.Ub().enterPhone()})),O.pc(7,"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"),O.Kb(),O.Kb(),O.oc(8,m,2,0,"div",14),O.Kb()}if(2&n){var o=O.Ub();O.yb(4),O.bc("ngIf",o.error_phone),O.yb(1),O.bc("showMaskTyped",!0)("ngModel",o.phone),O.yb(3),O.bc("ngIf",o.loader)}}function M(n,t){1&n&&(O.Lb(0,"span",15),O.pc(1,"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043a\u043e\u0434"),O.Kb())}function j(n,t){1&n&&(O.Lb(0,"div",16),O.Jb(1,"i-feather",17),O.Kb())}var I=function(n){return{"btn-resend":n}};function L(n,t){if(1&n){var e=O.Mb();O.Lb(0,"div",18),O.Lb(1,"div",9),O.pc(2,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434"),O.Kb(),O.Lb(3,"div",10),O.oc(4,M,2,0,"span",11),O.Lb(5,"input",19),O.Sb("ngModelChange",(function(n){return O.jc(e),O.Ub().code=n}))("input",(function(){return O.jc(e),O.Ub().changePhone()})),O.Kb(),O.Lb(6,"button",13),O.Sb("click",(function(){return O.jc(e),O.Ub().enterCode()})),O.pc(7,"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"),O.Kb(),O.Lb(8,"button",20),O.Sb("click",(function(){return O.jc(e),O.Ub().reEnterPhone()})),O.pc(9),O.Kb(),O.Kb(),O.oc(10,j,2,0,"div",14),O.Kb()}if(2&n){var o=O.Ub();O.yb(4),O.bc("ngIf",o.error_phone),O.yb(1),O.bc("showMaskTyped",!0)("ngModel",o.code),O.yb(3),O.bc("ngClass",O.ec(6,I,o.resend_dis)),O.yb(1),O.rc(" \u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e ",o.dis_timer," "),O.yb(1),O.bc("ngIf",o.loader)}}var K,S,A=function(n){return{"btn-open":n}},U=[{path:"",component:(K=function(){function e(t,o,i,s,c,r,b,a,h,u,d){var l=this;n(this,e),this.auth=t,this.router=o,this.alert=i,this.plt=s,this.http=c,this.state$=r,this.AP=b,this.courier=a,this.settings=h,this.sys=u,this.sysMap=d,this.pl_window=!1,this.error_phone=!1,this.phone="",this.loader=!1,this.auth_step=!1,this.code=null,this.resend_dis=!1,this.dis_timer=null,this.$stopTimer=new p.a;var g=this;this.plt.ready().then((function(n){console.log("sys:: \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0430 \u0433\u043e\u0442\u043e\u0432\u0430:",n),"android"==n&&l.AP.requestPermission(l.AP.PERMISSION.ACCESS_FINE_LOCATION),l.auth.checkAuth().subscribe((function(n){"true"==n.success&&(l.auth.setUser(n.sync_id),l.settings.getSettings(n.sync_id),g.router.navigate(["map"]),g.auth.initLogin())}))}))}var o,i,s;return o=e,(i=[{key:"ngOnInit",value:function(){"true"==localStorage.debug&&(this.auth.isDebug=!0)}},{key:"scanAuth",value:function(){var n=this,t=this;this.auth.scanData().then((function(e){var o=e.text.slice(0,-4);localStorage.setItem("cId",o),t.auth.login({action:"auth",barcode:e.text}).subscribe((function(e){"true"==e.success?(t.auth.initLogin(),n.auth.setUser(e.sync_id),n.settings.getSettings(e.sync_id),t.router.navigate(["map"])):t.auth.showError(1)}))}))}},{key:"phoneAuth",value:function(){this.auth_step||(this.pl_window=!this.pl_window)}},{key:"enterPhone",value:function(){this.phone&&this.phone.length>9?(this.loader=!0,this.sendPhone()):this.error_phone=!0}},{key:"changePhone",value:function(){this.error_phone=!1}},{key:"sendPhone",value:function(){var n=this,t=this;this.sendPost(this.sys.proxy+"https://mok.flexcore.ru/client/registerP/","action=registerP&phone=8"+this.phone+"&type=courier").subscribe((function(e){"true"==e.success?t.authStep():n.showLoginError(4)}),(function(t){n.showLoginError(3)})),this.startTimer()}},{key:"sendPost",value:function(n,t){console.log("send_data",t);var e={headers:new d.e({"Access-Control-Allow-Origin":"*","Content-type":"application/x-www-form-urlencoded","Access-Control-Allow-Headers":"*"})};return this.http.post(n,t,e)}},{key:"authStep",value:function(){this.auth_step=!0,this.loader=!1}},{key:"enterCode",value:function(){var n=this;this.sendPost(this.sys.proxy+"https://mok.flexcore.ru/courier/authP/","action=authP&phone=8"+this.phone+"&code="+this.code+"&type=courier").subscribe((function(t){console.log("sendCode",t),"true"==t.success?n.login(t.user):n.error_phone=!0}))}},{key:"login",value:function(n){var t=this,e="33dbcda2db5311e39760309e88d17f08,"+n;localStorage.setItem("cId",n);var o=this;this.auth.login({action:"auth",barcode:e}).subscribe((function(n){"true"==n.success?(t.auth.setUser(n.sync_id),t.settings.getSettings(n.sync_id),o.router.navigate(["map"]),o.auth.initLogin()):o.auth.showError(1)}))}},{key:"showLoginError",value:function(n){switch(n){case 3:case 4:this.loader=!1,this.phone=null,this.pl_window=!1,this.auth.showError(n)}}},{key:"startTimer",value:function(){if(this.resend_dis)return!1;this.resend_dis=!0,this.dis_timer=30;var n=this;this.state$.interval_1ss.pipe(Object(g.a)(this.$stopTimer)).subscribe((function(){n.dis_timer--,0==n.dis_timer&&(n.dis_timer=null,n.$stopTimer.next(),n.resend_dis=!1)}))}},{key:"reEnterPhone",value:function(){if(this.resend_dis)return!1;this.sendPhone()}},{key:"changeCode",value:function(){}}])&&t(o.prototype,i),s&&t(o,s),e}(),K.\u0275fac=function(n){return new(n||K)(O.Ib(y.a),O.Ib(r.g),O.Ib(a.a),O.Ib(a.I),O.Ib(d.b),O.Ib(w.a),O.Ib(l.a),O.Ib(_.a),O.Ib(v.a),O.Ib(x.a),O.Ib(f.a))},K.\u0275cmp=O.Cb({type:K,selectors:[["app-login"]],decls:11,vars:7,consts:[[1,"lg-wrp"],[1,"lg-btn"],[1,"lg-login",3,"click"],[1,"lg-login","login-phone",3,"ngClass"],[1,"btn-wrp"],[1,"btn-title",3,"click"],["class","btn-body phone-b",4,"ngIf"],["class","btn-body code-b",4,"ngIf"],[1,"btn-body","phone-b"],[1,"bi-title"],[1,"bi-inp"],["class","error-phone",4,"ngIf"],["type","tel","prefix","+7 ","mask","(000) 000 00 00",1,"phone-inp",3,"showMaskTyped","ngModel","ngModelChange","input"],[1,"enter-phone",3,"click"],["class","sh-icons",4,"ngIf"],[1,"error-phone"],[1,"sh-icons"],["name","loader"],[1,"btn-body","code-b"],["type","tel","mask","00-00",1,"phone-inp",3,"showMaskTyped","ngModel","ngModelChange","input"],[1,"enter-phone",3,"ngClass","click"]],template:function(n,t){1&n&&(O.Lb(0,"ion-content"),O.Lb(1,"div",0),O.Lb(2,"div",1),O.Lb(3,"button",2),O.Sb("click",(function(){return t.scanAuth()})),O.pc(4," \u0412\u043e\u0439\u0442\u0438 \u043f\u043e QR-\u043a\u043e\u0434\u0443 "),O.Kb(),O.Lb(5,"button",3),O.Lb(6,"div",4),O.Lb(7,"div",5),O.Sb("click",(function(){return t.phoneAuth()})),O.pc(8,"\u0412\u043e\u0439\u0442\u0438 \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430"),O.Kb(),O.oc(9,k,9,4,"div",6),O.oc(10,L,11,8,"div",7),O.Kb(),O.Kb(),O.Kb(),O.Kb(),O.Kb()),2&n&&(O.yb(3),O.bc("@openClose1",t.auth_step?"closed":"open"),O.yb(2),O.bc("ngClass",O.ec(5,A,t.pl_window))("@openClose",t.pl_window?"open":"closed"),O.yb(4),O.bc("ngIf",!t.auth_step),O.yb(1),O.bc("ngIf",t.auth_step))},directives:[a.i,s.j,s.l,b.a,c.a,c.f,c.g,C.a],styles:[".lg-wrp[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;bottom:0}.lg-btn[_ngcontent-%COMP%], .lg-wrp[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.lg-btn[_ngcontent-%COMP%]{min-height:22%;width:80%;flex-direction:column}.lg-login[_ngcontent-%COMP%]{outline:none;height:50px;width:100%;background:no-repeat;box-shadow:0 0 1px 1px #bdbdbd;border-radius:3px;color:#4a4a4a;font-size:19px;margin:5px 0}.login-phone[_ngcontent-%COMP%]{overflow:hidden;padding:0}.btn-title[_ngcontent-%COMP%]{color:#4a4a4a;font-size:19px}.btn-wrp[_ngcontent-%COMP%]{height:100%;display:grid;grid-template-rows:50px auto}.btn-title[_ngcontent-%COMP%]{height:50px;width:100%}.btn-body[_ngcontent-%COMP%], .btn-title[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.btn-body[_ngcontent-%COMP%]{flex-direction:column;position:relative}.error-phone[_ngcontent-%COMP%]{font-size:15px;color:#c50000}.phone-inp[_ngcontent-%COMP%]{margin:6px 0 0;height:45px;border:none;box-shadow:0 0 1px 1px #bdbdbd;border-radius:3px;text-align:center}.btn-open[_ngcontent-%COMP%]   .btn-title[_ngcontent-%COMP%]{border-bottom:1px solid #bdbdbd}.enter-phone[_ngcontent-%COMP%]{margin:8px 0 0;height:45px;border:none;background:none;box-shadow:0 0 1px 1px #bdbdbd;border-radius:3px;text-align:center;font-size:20px;width:100%;color:#2b637e;outline:none}.bi-inp[_ngcontent-%COMP%]{flex-direction:column;padding:12px 0 0}.bi-inp[_ngcontent-%COMP%], .sh-icons[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.sh-icons[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.1);font-size:35px;color:#2b637e}.btn-resend[_ngcontent-%COMP%]{color:#8d999e}"],data:{animation:[Object(u.j)("openClose",[Object(u.g)("open",Object(u.h)({height:"264px"})),Object(u.g)("closed",Object(u.h)({height:"50px"})),Object(u.i)("open => closed",[Object(u.e)("0.5s")]),Object(u.i)("closed => open",[Object(u.e)("0.5s")])]),Object(u.j)("openClose1",[Object(u.g)("open",Object(u.h)({height:"50px"})),Object(u.g)("closed",Object(u.h)({height:"0px",display:"none"})),Object(u.i)("open => closed",[Object(u.e)("0.5s")]),Object(u.i)("closed => open",[Object(u.e)("0.5s")])])]}}),K)}],E=((S=function t(){n(this,t)}).\u0275mod=O.Gb({type:S}),S.\u0275inj=O.Fb({factory:function(n){return new(n||S)},imports:[[h.a,s.c,c.b,a.E,b.b.forRoot(),r.i.forChild(U)]]}),S)}}])}();