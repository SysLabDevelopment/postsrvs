!function(){function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function n(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{F4UR:function(e,o,i){"use strict";i.r(o),i.d(o,"LoginPageModule",(function(){return E}));var s=i("SVse"),c=i("s7LF"),r=i("iInd"),a=i("bOtU"),h=i("sZkV"),b=i("sbs8"),u=i("GS7A"),d=i("IheW"),p=i("4zgz"),l=i("XNiG"),g=i("1G5W"),f=i("D279"),y=i("lGQG"),v=i("24R0"),_=i("6nr9"),k=i("ndxW"),x=i("tudd"),w=i("fXoL"),C=i("1tbR");function O(t,n){if(1&t&&(w.Lb(0,"div",9),w.qc(1),w.Kb()),2&t){var e=w.Vb();w.yb(1),w.sc(" ",e.state$.notificationStr," ")}}function m(t,n){1&t&&(w.Lb(0,"span",17),w.qc(1,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0442\u0435\u043b\u0435\u0444\u043e\u043d"),w.Kb())}function P(t,n){1&t&&(w.Lb(0,"div",18),w.Jb(1,"i-feather",19),w.Kb())}function M(t,n){if(1&t){var e=w.Mb();w.Lb(0,"div",10),w.Lb(1,"div",11),w.qc(2,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u043c\u0435\u0440"),w.Kb(),w.Lb(3,"div",12),w.pc(4,m,2,0,"span",13),w.Lb(5,"input",14),w.Tb("ngModelChange",(function(t){return w.kc(e),w.Vb().phone=t}))("input",(function(){return w.kc(e),w.Vb().changePhone()})),w.Kb(),w.Lb(6,"button",15),w.Tb("click",(function(){return w.kc(e),w.Vb().enterPhone()})),w.qc(7,"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"),w.Kb(),w.Kb(),w.pc(8,P,2,0,"div",16),w.Kb()}if(2&t){var o=w.Vb();w.yb(4),w.cc("ngIf",o.error_phone),w.yb(1),w.cc("showMaskTyped",!0)("ngModel",o.phone),w.yb(3),w.cc("ngIf",o.loader)}}function I(t,n){1&t&&(w.Lb(0,"span",17),w.qc(1,"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043a\u043e\u0434"),w.Kb())}function L(t,n){1&t&&(w.Lb(0,"div",18),w.Jb(1,"i-feather",19),w.Kb())}var j=function(t){return{"btn-resend":t}};function K(t,n){if(1&t){var e=w.Mb();w.Lb(0,"div",20),w.Lb(1,"div",11),w.qc(2,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434"),w.Kb(),w.Lb(3,"div",12),w.pc(4,I,2,0,"span",13),w.Lb(5,"input",21),w.Tb("ngModelChange",(function(t){return w.kc(e),w.Vb().code=t}))("input",(function(){return w.kc(e),w.Vb().changePhone()})),w.Kb(),w.Lb(6,"button",15),w.Tb("click",(function(){return w.kc(e),w.Vb().enterCode()})),w.qc(7,"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"),w.Kb(),w.Lb(8,"button",22),w.Tb("click",(function(){return w.kc(e),w.Vb().reEnterPhone()})),w.qc(9),w.Kb(),w.Kb(),w.pc(10,L,2,0,"div",16),w.Kb()}if(2&t){var o=w.Vb();w.yb(4),w.cc("ngIf",o.error_phone),w.yb(1),w.cc("showMaskTyped",!0)("ngModel",o.code),w.yb(3),w.cc("ngClass",w.fc(6,j,o.resend_dis)),w.yb(1),w.sc(" \u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e ",o.dis_timer," "),w.yb(1),w.cc("ngIf",o.loader)}}var T,S,A=function(t){return{"btn-open":t}},V=[{path:"",component:(T=function(){function e(n,o,i,s,c,r,a,h,b,u,d){var p=this;t(this,e),this.auth=n,this.router=o,this.alert=i,this.plt=s,this.http=c,this.state$=r,this.AP=a,this.courier=h,this.settings=b,this.sys=u,this.sysMap=d,this.pl_window=!1,this.error_phone=!1,this.phone="",this.loader=!1,this.auth_step=!1,this.code=null,this.resend_dis=!1,this.dis_timer=null,this.$stopTimer=new l.a;var g=this;this.plt.ready().then((function(t){console.log("sys:: \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0430 \u0433\u043e\u0442\u043e\u0432\u0430:",t),"android"==t&&p.AP.requestPermission(p.AP.PERMISSION.ACCESS_FINE_LOCATION),p.auth.version=AppVersion.version,p.auth.checkAuth().subscribe((function(t){"true"==t.success&&(p.auth.setUser(t.sync_id),p.settings.getSettings(t.sync_id),g.router.navigate(["map"]),g.auth.initLogin())}))}))}var o,i,s;return o=e,(i=[{key:"ngOnInit",value:function(){var t=this;this.isCheckedToWork().subscribe((function(n){n.checked&&(t.courier.checkedOnWork=!0)})),this.auth.getUserId()||(this.courier.checkedOnWork=!0),"true"==localStorage.debug&&(this.auth.isDebug=!0)}},{key:"isCheckedToWork",value:function(){var t={token:"l;sdfjkhglsoapl[",cId:localStorage.userId};return this.http.post(this.sys.proxy+"https://mobile.postsrvs.ru/admin/ajax/is_checked_to_work.php",t,{headers:{"Content-type":"application/json"}})}},{key:"scanAuth",value:function(){var t=this,n=this;this.auth.scanData().then((function(e){var o=e.text.slice(0,-4);localStorage.setItem("cId",o),n.auth.login({action:"auth",barcode:e.text}).subscribe((function(e){"true"==e.success?(n.auth.initLogin(),t.auth.setUser(e.sync_id),t.settings.getSettings(e.sync_id),n.router.navigate(["map"])):n.auth.showError(1)}))}))}},{key:"phoneAuth",value:function(){this.auth_step||(this.pl_window=!this.pl_window)}},{key:"enterPhone",value:function(){this.phone&&this.phone.length>9?(this.loader=!0,this.sendPhone()):this.error_phone=!0}},{key:"changePhone",value:function(){this.error_phone=!1}},{key:"sendPhone",value:function(){var t=this,n=this;this.sendPost(this.sys.proxy+"https://mok.flexcore.ru/client/registerP/","action=registerP&phone=8"+this.phone+"&type=courier").subscribe((function(e){t.state$.unsetNotification("internet"),"true"==e.success?n.authStep():t.showLoginError(4)}),(function(n){t.showLoginError(3)})),this.startTimer()}},{key:"sendPost",value:function(t,n){console.log("send_data",n);var e={headers:new d.e({"Access-Control-Allow-Origin":"*","Content-type":"application/x-www-form-urlencoded","Access-Control-Allow-Headers":"*"})};return this.http.post(t,n,e)}},{key:"authStep",value:function(){this.auth_step=!0,this.loader=!1}},{key:"enterCode",value:function(){var t=this;this.sendPost(this.sys.proxy+"https://mok.flexcore.ru/courier/authP/","action=authP&phone=8"+this.phone+"&code="+this.code+"&type=courier").subscribe((function(n){console.log("sendCode",n),"true"==n.success?t.login(n.user):t.error_phone=!0}))}},{key:"login",value:function(t){var n=this,e="33dbcda2db5311e39760309e88d17f08,"+t;localStorage.setItem("cId",t);var o=this;this.auth.login({action:"auth",barcode:e}).subscribe((function(t){"true"==t.success?(n.auth.setUser(t.sync_id),n.settings.getSettings(t.sync_id),o.router.navigate(["map"]),o.auth.initLogin()):o.auth.showError(1)}))}},{key:"showLoginError",value:function(t){switch(t){case 3:case 4:this.loader=!1,this.phone=null,this.pl_window=!1,this.auth.showError(t)}}},{key:"startTimer",value:function(){if(this.resend_dis)return!1;this.resend_dis=!0,this.dis_timer=30;var t=this;this.state$.interval_1ss.pipe(Object(g.a)(this.$stopTimer)).subscribe((function(){t.dis_timer--,0==t.dis_timer&&(t.dis_timer=null,t.$stopTimer.next(),t.resend_dis=!1)}))}},{key:"reEnterPhone",value:function(){if(this.resend_dis)return!1;this.sendPhone()}},{key:"changeCode",value:function(){}}])&&n(o.prototype,i),s&&n(o,s),e}(),T.\u0275fac=function(t){return new(t||T)(w.Ib(y.a),w.Ib(r.g),w.Ib(h.a),w.Ib(h.J),w.Ib(d.b),w.Ib(k.a),w.Ib(p.a),w.Ib(v.a),w.Ib(_.a),w.Ib(x.a),w.Ib(f.a))},T.\u0275cmp=w.Cb({type:T,selectors:[["app-login"]],decls:12,vars:8,consts:[["class","notification",4,"ngIf"],[1,"lg-wrp"],[1,"lg-btn"],[1,"lg-login",3,"click"],[1,"lg-login","login-phone",3,"ngClass"],[1,"btn-wrp"],[1,"btn-title",3,"click"],["class","btn-body phone-b",4,"ngIf"],["class","btn-body code-b",4,"ngIf"],[1,"notification"],[1,"btn-body","phone-b"],[1,"bi-title"],[1,"bi-inp"],["class","error-phone",4,"ngIf"],["type","tel","prefix","+7 ","mask","(000) 000 00 00",1,"phone-inp",3,"showMaskTyped","ngModel","ngModelChange","input"],[1,"enter-phone",3,"click"],["class","sh-icons",4,"ngIf"],[1,"error-phone"],[1,"sh-icons"],["name","loader"],[1,"btn-body","code-b"],["type","tel","mask","00-00",1,"phone-inp",3,"showMaskTyped","ngModel","ngModelChange","input"],[1,"enter-phone",3,"ngClass","click"]],template:function(t,n){1&t&&(w.Lb(0,"ion-content"),w.pc(1,O,2,1,"div",0),w.Lb(2,"div",1),w.Lb(3,"div",2),w.Lb(4,"button",3),w.Tb("click",(function(){return n.scanAuth()})),w.qc(5," \u0412\u043e\u0439\u0442\u0438 \u043f\u043e QR-\u043a\u043e\u0434\u0443 "),w.Kb(),w.Lb(6,"button",4),w.Lb(7,"div",5),w.Lb(8,"div",6),w.Tb("click",(function(){return n.phoneAuth()})),w.qc(9,"\u0412\u043e\u0439\u0442\u0438 \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430"),w.Kb(),w.pc(10,M,9,4,"div",7),w.pc(11,K,11,8,"div",8),w.Kb(),w.Kb(),w.Kb(),w.Kb(),w.Kb()),2&t&&(w.yb(1),w.cc("ngIf",n.state$.notificationStr&&""!=n.state$.notificationStr),w.yb(3),w.cc("@openClose1",n.auth_step?"closed":"open"),w.yb(2),w.cc("ngClass",w.fc(6,A,n.pl_window))("@openClose",n.pl_window?"open":"closed"),w.yb(4),w.cc("ngIf",!n.auth_step),w.yb(1),w.cc("ngIf",n.auth_step))},directives:[h.j,s.l,s.j,a.a,c.a,c.f,c.g,C.a],styles:[".lg-wrp[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;bottom:0}.lg-btn[_ngcontent-%COMP%], .lg-wrp[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.lg-btn[_ngcontent-%COMP%]{min-height:22%;width:80%;flex-direction:column}.lg-login[_ngcontent-%COMP%]{outline:none;height:50px;width:100%;background:no-repeat;box-shadow:0 0 1px 1px #bdbdbd;border-radius:3px;color:#4a4a4a;font-size:19px;margin:5px 0}.login-phone[_ngcontent-%COMP%]{overflow:hidden;padding:0}.btn-title[_ngcontent-%COMP%]{color:#4a4a4a;font-size:19px}.btn-wrp[_ngcontent-%COMP%]{height:100%;display:grid;grid-template-rows:50px auto}.btn-title[_ngcontent-%COMP%]{height:50px;width:100%}.btn-body[_ngcontent-%COMP%], .btn-title[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.btn-body[_ngcontent-%COMP%]{flex-direction:column;position:relative}.error-phone[_ngcontent-%COMP%]{font-size:15px;color:#c50000}.phone-inp[_ngcontent-%COMP%]{margin:6px 0 0;height:45px;border:none;box-shadow:0 0 1px 1px #bdbdbd;border-radius:3px;text-align:center}.btn-open[_ngcontent-%COMP%]   .btn-title[_ngcontent-%COMP%]{border-bottom:1px solid #bdbdbd}.enter-phone[_ngcontent-%COMP%]{margin:8px 0 0;height:45px;border:none;background:none;box-shadow:0 0 1px 1px #bdbdbd;border-radius:3px;text-align:center;font-size:20px;width:100%;color:#2b637e;outline:none}.bi-inp[_ngcontent-%COMP%]{flex-direction:column;padding:12px 0 0}.bi-inp[_ngcontent-%COMP%], .sh-icons[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.sh-icons[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.1);font-size:35px;color:#2b637e}.btn-resend[_ngcontent-%COMP%]{color:#8d999e}.notification[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;background:rgba(192,26,26,.472);min-height:30px;color:#d21212;font-size:15px;z-index:99;display:flex;justify-content:center;align-items:center}"],data:{animation:[Object(u.j)("openClose",[Object(u.g)("open",Object(u.h)({height:"264px"})),Object(u.g)("closed",Object(u.h)({height:"50px"})),Object(u.i)("open => closed",[Object(u.e)("0.5s")]),Object(u.i)("closed => open",[Object(u.e)("0.5s")])]),Object(u.j)("openClose1",[Object(u.g)("open",Object(u.h)({height:"50px"})),Object(u.g)("closed",Object(u.h)({height:"0px",display:"none"})),Object(u.i)("open => closed",[Object(u.e)("0.5s")]),Object(u.i)("closed => open",[Object(u.e)("0.5s")])])]}}),T)}],E=((S=function n(){t(this,n)}).\u0275mod=w.Gb({type:S}),S.\u0275inj=w.Fb({factory:function(t){return new(t||S)},imports:[[b.a,s.c,c.b,h.F,a.b.forRoot(),r.i.forChild(V)]]}),S)}}])}();